/*
 * YellowJS v0.5 - mobile framework
 * http://yellowjs.org
 */
(function(){my={};my.Class=function(){var e=arguments.length;var d=arguments[e-1];var f=e>1?arguments[0]:null;var j=e>2;var g,c;if(d.constructor===Object){g=function(){}}else{g=d.constructor;delete d.constructor}if(f){c=function(){};c.prototype=f.prototype;g.prototype=new c();g.prototype.constructor=g;g.Super=f;b(g,f,false)}if(j){for(var h=1;h<e-1;h++){b(g.prototype,arguments[h].prototype,false)}}a(g,d);return g};var a=my.extendClass=function(c,e,d){if(e.STATIC){b(c,e.STATIC,d);delete e.STATIC}b(c.prototype,e,d)};var b=function(d,f,c){var e;if(c===false){for(e in f){if(!(e in d)){d[e]=f[e]}}}else{for(e in f){d[e]=f[e]}if(f.toString!==Object.prototype.toString){d.toString=f.toString}}}})();
/*
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(w){w.name="mustache.js";w.version="0.5.0-dev";w.tags=["{{","}}"];w.parse=n;w.compile=f;w.render=v;w.clearCache=u;w.to_html=v;var t=Object.prototype.toString;var g=Array.isArray;var c=Array.prototype.forEach;var h=String.prototype.trim;var j;if(g){j=g}else{j=function(x){return t.call(x)==="[object Array]"}}var s;if(c){s=function(y,z,x){return c.call(y,z,x)}}else{s=function(A,B,z){for(var y=0,x=A.length;y<x;++y){B.call(z,A[y],y,A)}}}var k=/^\s*$/;function d(x){return k.test(x)}var q;if(h){q=function(x){return x==null?"":h.call(x)}}else{var o,i;if(d("\xA0")){o=/^\s+/;i=/\s+$/}else{o=/^[\s\xA0]+/;i=/[\s\xA0]+$/}q=function(x){return x==null?"":String(x).replace(o,"").replace(i,"")}}var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function p(x){return String(x).replace(/&(?!\w+;)|[<>"']/g,function(y){return e[y]||y})}function l(D,F,G,z){z=z||"<template>";var H=F.split("\n"),x=Math.max(G-3,0),A=Math.min(H.length,G+3),y=H.slice(x,A);var E;for(var B=0,C=y.length;B<C;++B){E=B+x+1;y[B]=(E===G?" >> ":"    ")+y[B]}D.template=F;D.line=G;D.file=z;D.message=[z+":"+G,y.join("\n"),"",D.message].join("\n");return D}function m(x,F,A){if(x==="."){return F[F.length-1]}var E=x.split(".");var C=E.length-1;var D=E[C];var G,y,B=F.length,z,H;while(B){H=F.slice(0);y=F[--B];z=0;while(z<C){y=y[E[z++]];if(y==null){break}H.push(y)}if(y&&D in y){G=y[D];break}}if(typeof G==="function"){G=G.call(H[H.length-1])}if(G==null&&!A){return""}return G}function a(C,z,E,x,y){var B=m(z,x,true);if(y){if(B==null||B===false||(j(B)&&B.length===0)){C(E())}}else{if(j(B)){s(B,function(F){x.push(F);C(E());x.pop()})}else{if(typeof B==="object"){x.push(B);C(E());x.pop()}else{if(typeof B==="function"){var A=x[x.length-1];var D=function(F){return v(F,A)};C(B.call(A,E(),D)||"")}else{if(B){C(E())}}}}}}function n(Z,B){B=B||{};var K=B.tags||w.tags,L=K[0],G=K[K.length-1];var y=["var line = 1;","\ntry {",'\nsend("'];var F=[],aa=false,X=false;var V=function(){if(aa&&!X&&!B.space){while(F.length){y.splice(F.pop(),1)}}else{F=[]}aa=false;X=false};var S=[],P,C,M;var U=function(ab){K=q(ab).split(/\s+/);C=K[0];M=K[K.length-1]};var J=function(ab){y.push('");',P,'\nvar partial = partials["'+q(ab)+'"];',"\nif (partial) {","\n  send(render(partial, stack[stack.length - 1], partials));","\n}",'\nsend("')};var x=function(ad,ab){var ac=q(ad);if(ac===""){throw l(new Error("Section name may not be empty"),Z,I,B.file)}S.push({name:ac,inverted:ab});y.push('");',P,'\nvar name = "'+ac+'";',"\nvar callback = (function () {","\n  var buffer, send = function (chunk) { buffer.push(chunk); };","\n  return function () {","\n    buffer = [];",'\nsend("')};var E=function(ab){x(ab,true)};var T=function(ac){var ab=q(ac);var ae=S.length!=0&&S[S.length-1].name;if(!ae||ab!=ae){throw l(new Error('Section named "'+ab+'" was never opened'),Z,I,file)}var ad=S.pop();y.push('");','\n    return buffer.join("");',"\n  };","\n})();");if(ad.inverted){y.push("\nsendSection(send,name,callback,stack,true);")}else{y.push("\nsendSection(send,name,callback,stack);")}y.push('\nsend("')};var W=function(ab){y.push('");',P,'\nsend(findName("'+q(ab)+'", stack));','\nsend("')};var z=function(ab){y.push('");',P,'\nsend(escapeHTML(findName("'+q(ab)+'", stack)));','\nsend("')};var I=1,Y,D;for(var Q=0,R=Z.length;Q<R;++Q){if(Z.slice(Q,Q+L.length)===L){Q+=L.length;Y=Z.substr(Q,1);P="\nline = "+I+";";C=L;M=G;aa=true;switch(Y){case"!":Q++;D=null;break;case"=":Q++;G="="+G;D=U;break;case">":Q++;D=J;break;case"#":Q++;D=x;break;case"^":Q++;D=E;break;case"/":Q++;D=T;break;case"{":G="}"+G;case"&":Q++;X=true;D=W;break;default:X=true;D=z}var A=Z.indexOf(G,Q);if(A===-1){throw l(new Error('Tag "'+L+'" was not closed properly'),Z,I,B.file)}var O=Z.substring(Q,A);if(D){D(O)}var N=0;while(~(N=O.indexOf("\n",N))){I++;N++}Q=A+G.length-1;L=C;G=M}else{Y=Z.substr(Q,1);switch(Y){case'"':case"\\":X=true;y.push("\\"+Y);break;case"\n":F.push(y.length);y.push("\\n");V();I++;break;default:if(d(Y)){F.push(y.length)}else{X=true}y.push(Y)}}}if(S.length!=0){throw l(new Error('Section "'+S[S.length-1].name+'" was not closed properly'),Z,I,B.file)}V();y.push('");',"\nsend(null);","\n} catch (e) { throw {error: e, line: line}; }");var H=y.join("").replace(/send\(""\);\n/g,"");if(B.debug){if(typeof console!="undefined"&&console.log){console.log(H)}else{if(typeof print==="function"){print(H)}}}return H}function r(B,z){var y="view,partials,send,stack,findName,escapeHTML,sendSection,render";var x=n(B,z);var A=new Function(y,x);return function(E,F,I){if(typeof F==="function"){I=F;F={}}F=F||{};var D=[];var H=I||function(J){D.push(J)};var C=[E];try{A(E,F,H,C,m,p,a,v)}catch(G){throw l(G.error,B,G.line,z.file)}return D.join("")}}var b={};function u(){b={}}function f(y,x){x=x||{};if(x.cache!==false){if(!b[y]){b[y]=r(y,x)}return b[y]}return r(y,x)}function v(z,x,y,A){return f(z)(x,y,A)}})(Mustache);var Lawnchair=function(){if(!JSON){throw"JSON unavailable! Include http://www.json.org/json2.js to fix."}if(arguments.length<=2&&arguments.length>0){var i=typeof arguments[0]==="function"?arguments[0]:arguments[1],n=typeof arguments[0]==="function"?{}:arguments[0]}else{throw"Incorrect # of ctor args!"}if(typeof i!=="function"){throw"No callback was provided"}var l=!(this instanceof Lawnchair)?new Lawnchair(n,i):this;l.record=n.record||"record";l.name=n.name||"records";var h;if(n.adapter){h=Lawnchair.adapters[l.indexOf(Lawnchair.adapters,n.adapter)];h=h.valid()?h:undefined}else{for(var m=0,k=Lawnchair.adapters.length;m<k;m++){if(h=Lawnchair.adapters[m].valid()?Lawnchair.adapters[m]:undefined){break}}}if(!h){throw"No valid adapter."}for(var j in h){l[j]=h[j]}m=0;for(k=Lawnchair.plugins.length;m<k;m++){Lawnchair.plugins[m].call(l)}l.init(n,i);return l};Lawnchair.adapters=[];Lawnchair.adapter=function(g,j){j.adapter=g;var h="adapter valid init keys save batch get exists all remove nuke".split(" "),f=this.prototype.indexOf,i;for(i in j){if(f(h,i)===-1){throw"Invalid adapter! Nonstandard method: "+i}}Lawnchair.adapters.push(j)};Lawnchair.plugins=[];Lawnchair.plugin=function(b){for(var d in b){d==="init"?Lawnchair.plugins.push(b[d]):this.prototype[d]=b[d]}};Lawnchair.prototype={isArray:Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"},indexOf:function(f,h,g,d){if(f.indexOf){return f.indexOf(h)}g=0;for(d=f.length;g<d;g++){if(f[g]===h){return g}}return -1},lambda:function(b){return this.fn(this.record,b)},fn:function(b,d){return typeof d=="string"?new Function(b,d):d},uuid:function(){var b=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b()},each:function(b){var f=this.lambda(b);if(this.__results){b=0;for(var d=this.__results.length;b<d;b++){f.call(this,this.__results[b],b)}}else{this.all(function(a){for(var e=0,c=a.length;e<c;e++){f.call(this,a[e],e)}})}return this}};Lawnchair.adapter("dom",{valid:function(){return !!window.Storage},init:function(b,f){this.storage=window.localStorage;var d=this;this.indexer={key:d.name+"._index_",all:function(){JSON.parse(d.storage.getItem(this.key))==null&&d.storage.setItem(this.key,JSON.stringify([]));return JSON.parse(d.storage.getItem(this.key))},add:function(a){var c=this.all();c.push(a);d.storage.setItem(this.key,JSON.stringify(c))},del:function(a){for(var j=this.all(),i=[],e=0,c=j.length;e<c;e++){j[e]!=a&&i.push(j[e])}d.storage.setItem(this.key,JSON.stringify(i))},find:function(a){for(var h=this.all(),e=0,c=h.length;e<c;e++){if(a===h[e]){return e}}return false}};f&&this.fn(this.name,f).call(this,this)},save:function(b,f){var d=b.key||this.uuid();this.indexer.find(d)||this.indexer.add(d);delete b.key;this.storage.setItem(d,JSON.stringify(b));if(f){b.key=d;this.lambda(f).call(this,b)}return this},batch:function(g,j){for(var h=[],f=0,i=g.length;f<i;f++){this.save(g[f],function(a){h.push(a)})}j&&this.lambda(j).call(this,h);return this},keys:function(){callback&&this.lambda(callback).call(this,this.indexer.all())},get:function(h,l){if(this.isArray(h)){for(var j=[],g=0,k=h.length;g<k;g++){var i=JSON.parse(this.storage.getItem(h[g]));if(i){i.key=h[g];j.push(i)}}l&&this.lambda(l).call(this,j)}else{if(i=JSON.parse(this.storage.getItem(h))){i.key=h}l&&this.lambda(l).call(this,i)}return this},all:function(h){for(var l=this.indexer.all(),j=[],g,k=0,i=l.length;k<i;k++){g=JSON.parse(this.storage.getItem(l[k]));g.key=l[k];j.push(g)}h&&this.fn(this.name,h).call(this,j);return this},remove:function(b,f){var d=typeof b==="string"?b:b.key;this.indexer.del(d);this.storage.removeItem(d);f&&this.lambda(f).call(this);return this},nuke:function(b){this.all(function(f){for(var d=0,a=f.length;d<a;d++){this.remove(f[d])}b&&this.lambda(b).call(this)});return this}});Lawnchair.adapter("window-name",function(b,f){var d=window.top.name?JSON.parse(window.top.name):{};return{valid:function(){return typeof window.top.name!="undefined"},init:function(a,c){d[this.name]={index:[],store:{}};b=d[this.name].index;f=d[this.name].store;this.fn(this.name,c).call(this,this)},keys:function(a){this.fn("keys",a).call(this,b);return this},save:function(a,e){var c=a.key||this.uuid();a.key&&delete a.key;this.exists(c,function(h){h||b.push(c);f[c]=a;window.top.name=JSON.stringify(d);if(e){a.key=c;this.lambda(e).call(this,a)}});return this},batch:function(a,j){for(var i=[],e=0,c=a.length;e<c;e++){this.save(a[e],function(g){i.push(g)})}j&&this.lambda(j).call(this,i);return this},get:function(a,j){var i;if(this.isArray(a)){i=[];for(var e=0,c=a.length;e<c;e++){i.push(f[a[e]])}}else{if(i=f[a]){i.key=a}}j&&this.lambda(j).call(this,i);return this},exists:function(a,c){this.lambda(c).call(this,!!f[a]);return this},all:function(a){for(var j=[],i=0,e=b.length;i<e;i++){var c=f[b[i]];c.key=b[i];j.push(c)}this.fn(this.name,a).call(this,j);return this},remove:function(a,j){for(var i=this.isArray(a)?a:[a],e=0,c=i.length;e<c;e++){delete f[i[e]];b.splice(this.indexOf(b,i[e]),1)}window.top.name=JSON.stringify(d);j&&this.lambda(j).call(this);return this},nuke:function(a){storage={};b=[];window.top.name=JSON.stringify(d);a&&this.lambda(a).call(this);return this}}}());
/*
 * iScroll v4.1.9 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
(function(){var r=Math,d=function(m){return m>>0},v=(/webkit/i).test(navigator.appVersion)?"webkit":(/firefox/i).test(navigator.userAgent)?"Moz":(/trident/i).test(navigator.userAgent)?"ms":"opera" in window?"O":"",w=(/android/gi).test(navigator.appVersion),i=(/iphone|ipad/gi).test(navigator.appVersion),c=(/playbook/gi).test(navigator.appVersion),n=(/hp-tablet/gi).test(navigator.appVersion),k="WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix(),u="ontouchstart" in window&&!n,f=v+"Transform" in document.documentElement.style,g=i||c,o=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){return setTimeout(m,1)}})(),l=(function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})(),h="onorientationchange" in window?"orientationchange":"resize",b=u?"touchstart":"mousedown",p=u?"touchmove":"mousemove",e=u?"touchend":"mouseup",t=u?"touchcancel":"mouseup",q=v=="Moz"?"DOMMouseScroll":"mousewheel",a="translate"+(k?"3d(":"("),j=k?",0)":")",s=function(y,m){var z=this,A=document,x;z.wrapper=typeof y=="object"?y:A.getElementById(y);z.wrapper.style.overflow="hidden";z.scroller=z.wrapper.children[0];z.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,topOffset:0,checkDOMChanges:false,hScrollbar:true,vScrollbar:true,fixedScrollbar:w,hideScrollbar:i,fadeScrollbar:i&&k,scrollbarClass:"",zoom:false,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(B){B.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(x in m){z.options[x]=m[x]}z.x=z.options.x;z.y=z.options.y;z.options.useTransform=f?z.options.useTransform:false;z.options.hScrollbar=z.options.hScroll&&z.options.hScrollbar;z.options.vScrollbar=z.options.vScroll&&z.options.vScrollbar;z.options.zoom=z.options.useTransform&&z.options.zoom;z.options.useTransition=g&&z.options.useTransition;if(z.options.zoom&&w){a="translate(";j=")"}z.scroller.style[v+"TransitionProperty"]=z.options.useTransform?"-"+v.toLowerCase()+"-transform":"top left";z.scroller.style[v+"TransitionDuration"]="0";z.scroller.style[v+"TransformOrigin"]="0 0";if(z.options.useTransition){z.scroller.style[v+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"}if(z.options.useTransform){z.scroller.style[v+"Transform"]=a+z.x+"px,"+z.y+"px"+j}else{z.scroller.style.cssText+=";position:absolute;top:"+z.y+"px;left:"+z.x+"px"}if(z.options.useTransition){z.options.fixedScrollbar=true}z.refresh();z._bind(h,window);z._bind(b);if(!u){z._bind("mouseout",z.wrapper);if(z.options.wheelAction!="none"){z._bind(q)}}if(z.options.checkDOMChanges){z.checkDOMTime=setInterval(function(){z._checkDOMChanges()},500)}};s.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(x){var m=this;switch(x.type){case b:if(!u&&x.button!==0){return}m._start(x);break;case p:m._move(x);break;case e:case t:m._end(x);break;case h:m._resize();break;case q:m._wheel(x);break;case"mouseout":m._mouseout(x);break;case"webkitTransitionEnd":m._transitionEnd(x);break}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||(this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)){return}this.refresh()},_scrollbar:function(m){var y=this,z=document,x;if(!y[m+"Scrollbar"]){if(y[m+"ScrollbarWrapper"]){if(f){y[m+"ScrollbarIndicator"].style[v+"Transform"]=""}y[m+"ScrollbarWrapper"].parentNode.removeChild(y[m+"ScrollbarWrapper"]);y[m+"ScrollbarWrapper"]=null;y[m+"ScrollbarIndicator"]=null}return}if(!y[m+"ScrollbarWrapper"]){x=z.createElement("div");if(y.options.scrollbarClass){x.className=y.options.scrollbarClass+m.toUpperCase()}else{x.style.cssText="position:absolute;z-index:100;"+(m=="h"?"height:7px;bottom:1px;left:2px;right:"+(y.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(y.hScrollbar?"7":"2")+"px;top:2px;right:1px")}x.style.cssText+=";pointer-events:none;-"+v+"-transition-property:opacity;-"+v+"-transition-duration:"+(y.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(y.options.hideScrollbar?"0":"1");y.wrapper.appendChild(x);y[m+"ScrollbarWrapper"]=x;x=z.createElement("div");if(!y.options.scrollbarClass){x.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+v+"-background-clip:padding-box;-"+v+"-box-sizing:border-box;"+(m=="h"?"height:100%":"width:100%")+";-"+v+"-border-radius:3px;border-radius:3px"}x.style.cssText+=";pointer-events:none;-"+v+"-transition-property:-"+v+"-transform;-"+v+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+v+"-transition-duration:0;-"+v+"-transform:"+a+"0,0"+j;if(y.options.useTransition){x.style.cssText+=";-"+v+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"}y[m+"ScrollbarWrapper"].appendChild(x);y[m+"ScrollbarIndicator"]=x}if(m=="h"){y.hScrollbarSize=y.hScrollbarWrapper.clientWidth;y.hScrollbarIndicatorSize=r.max(d(y.hScrollbarSize*y.hScrollbarSize/y.scrollerW),8);y.hScrollbarIndicator.style.width=y.hScrollbarIndicatorSize+"px";y.hScrollbarMaxScroll=y.hScrollbarSize-y.hScrollbarIndicatorSize;y.hScrollbarProp=y.hScrollbarMaxScroll/y.maxScrollX}else{y.vScrollbarSize=y.vScrollbarWrapper.clientHeight;y.vScrollbarIndicatorSize=r.max(d(y.vScrollbarSize*y.vScrollbarSize/y.scrollerH),8);y.vScrollbarIndicator.style.height=y.vScrollbarIndicatorSize+"px";y.vScrollbarMaxScroll=y.vScrollbarSize-y.vScrollbarIndicatorSize;y.vScrollbarProp=y.vScrollbarMaxScroll/y.maxScrollY}y._scrollbarPos(m,true)},_resize:function(){var m=this;setTimeout(function(){m.refresh()},w?200:0)},_pos:function(m,z){m=this.hScroll?m:0;z=this.vScroll?z:0;if(this.options.useTransform){this.scroller.style[v+"Transform"]=a+m+"px,"+z+"px"+j+" scale("+this.scale+")"}else{m=d(m);z=d(z);this.scroller.style.left=m+"px";this.scroller.style.top=z+"px"}this.x=m;this.y=z;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(m,z){var y=this,A=m=="h"?y.x:y.y,x;if(!y[m+"Scrollbar"]){return}A=y[m+"ScrollbarProp"]*A;if(A<0){if(!y.options.fixedScrollbar){x=y[m+"ScrollbarIndicatorSize"]+d(A*3);if(x<8){x=8}y[m+"ScrollbarIndicator"].style[m=="h"?"width":"height"]=x+"px"}A=0}else{if(A>y[m+"ScrollbarMaxScroll"]){if(!y.options.fixedScrollbar){x=y[m+"ScrollbarIndicatorSize"]-d((A-y[m+"ScrollbarMaxScroll"])*3);if(x<8){x=8}y[m+"ScrollbarIndicator"].style[m=="h"?"width":"height"]=x+"px";A=y[m+"ScrollbarMaxScroll"]+(y[m+"ScrollbarIndicatorSize"]-x)}else{A=y[m+"ScrollbarMaxScroll"]}}}y[m+"ScrollbarWrapper"].style[v+"TransitionDelay"]="0";y[m+"ScrollbarWrapper"].style.opacity=z&&y.options.hideScrollbar?"0":"1";y[m+"ScrollbarIndicator"].style[v+"Transform"]=a+(m=="h"?A+"px,0":"0,"+A+"px")+j},_start:function(E){var D=this,z=u?E.touches[0]:E,A,m,F,C,B;if(!D.enabled){return}if(D.options.onBeforeScrollStart){D.options.onBeforeScrollStart.call(D,E)}if(D.options.useTransition||D.options.zoom){D._transitionTime(0)}D.moved=false;D.animating=false;D.zoomed=false;D.distX=0;D.distY=0;D.absDistX=0;D.absDistY=0;D.dirX=0;D.dirY=0;if(D.options.zoom&&u&&E.touches.length>1){C=r.abs(E.touches[0].pageX-E.touches[1].pageX);B=r.abs(E.touches[0].pageY-E.touches[1].pageY);D.touchesDistStart=r.sqrt(C*C+B*B);D.originX=r.abs(E.touches[0].pageX+E.touches[1].pageX-D.wrapperOffsetLeft*2)/2-D.x;D.originY=r.abs(E.touches[0].pageY+E.touches[1].pageY-D.wrapperOffsetTop*2)/2-D.y;if(D.options.onZoomStart){D.options.onZoomStart.call(D,E)}}if(D.options.momentum){if(D.options.useTransform){A=getComputedStyle(D.scroller,null)[v+"Transform"].replace(/[^0-9-.,]/g,"").split(",");m=A[4]*1;F=A[5]*1}else{m=getComputedStyle(D.scroller,null).left.replace(/[^0-9-]/g,"")*1;F=getComputedStyle(D.scroller,null).top.replace(/[^0-9-]/g,"")*1}if(m!=D.x||F!=D.y){if(D.options.useTransition){D._unbind("webkitTransitionEnd")}else{l(D.aniTime)}D.steps=[];D._pos(m,F)}}D.absStartX=D.x;D.absStartY=D.y;D.startX=D.x;D.startY=D.y;D.pointX=z.pageX;D.pointY=z.pageY;D.startTime=E.timeStamp||Date.now();if(D.options.onScrollStart){D.options.onScrollStart.call(D,E)}D._bind(p);D._bind(e);D._bind(t)},_move:function(E){var C=this,F=u?E.touches[0]:E,A=F.pageX-C.pointX,y=F.pageY-C.pointY,m=C.x+A,G=C.y+y,B,z,x,D=E.timeStamp||Date.now();if(C.options.onBeforeScrollMove){C.options.onBeforeScrollMove.call(C,E)}if(C.options.zoom&&u&&E.touches.length>1){B=r.abs(E.touches[0].pageX-E.touches[1].pageX);z=r.abs(E.touches[0].pageY-E.touches[1].pageY);C.touchesDist=r.sqrt(B*B+z*z);C.zoomed=true;x=1/C.touchesDistStart*C.touchesDist*this.scale;if(x<C.options.zoomMin){x=0.5*C.options.zoomMin*Math.pow(2,x/C.options.zoomMin)}else{if(x>C.options.zoomMax){x=2*C.options.zoomMax*Math.pow(0.5,C.options.zoomMax/x)}}C.lastScale=x/this.scale;m=this.originX-this.originX*C.lastScale+this.x,G=this.originY-this.originY*C.lastScale+this.y;this.scroller.style[v+"Transform"]=a+m+"px,"+G+"px"+j+" scale("+x+")";if(C.options.onZoom){C.options.onZoom.call(C,E)}return}C.pointX=F.pageX;C.pointY=F.pageY;if(m>0||m<C.maxScrollX){m=C.options.bounce?C.x+(A/2):m>=0||C.maxScrollX>=0?0:C.maxScrollX}if(G>C.minScrollY||G<C.maxScrollY){G=C.options.bounce?C.y+(y/2):G>=C.minScrollY||C.maxScrollY>=0?C.minScrollY:C.maxScrollY}C.distX+=A;C.distY+=y;C.absDistX=r.abs(C.distX);C.absDistY=r.abs(C.distY);if(C.absDistX<6&&C.absDistY<6){return}if(C.options.lockDirection){if(C.absDistX>C.absDistY+5){G=C.y;y=0}else{if(C.absDistY>C.absDistX+5){m=C.x;A=0}}}C.moved=true;C._pos(m,G);C.dirX=A>0?-1:A<0?1:0;C.dirY=y>0?-1:y<0?1:0;if(D-C.startTime>300){C.startTime=D;C.startX=C.x;C.startY=C.y}if(C.options.onScrollMove){C.options.onScrollMove.call(C,E)}},_end:function(E){if(u&&E.touches.length!=0){return}var C=this,K=u?E.changedTouches[0]:E,F,J,y={dist:0,time:0},m={dist:0,time:0},B=(E.timeStamp||Date.now())-C.startTime,G=C.x,D=C.y,I,H,x,A,z;C._unbind(p);C._unbind(e);C._unbind(t);if(C.options.onBeforeScrollEnd){C.options.onBeforeScrollEnd.call(C,E)}if(C.zoomed){z=C.scale*C.lastScale;z=Math.max(C.options.zoomMin,z);z=Math.min(C.options.zoomMax,z);C.lastScale=z/C.scale;C.scale=z;C.x=C.originX-C.originX*C.lastScale+C.x;C.y=C.originY-C.originY*C.lastScale+C.y;C.scroller.style[v+"TransitionDuration"]="200ms";C.scroller.style[v+"Transform"]=a+C.x+"px,"+C.y+"px"+j+" scale("+C.scale+")";C.zoomed=false;C.refresh();if(C.options.onZoomEnd){C.options.onZoomEnd.call(C,E)}return}if(!C.moved){if(u){if(C.doubleTapTimer&&C.options.zoom){clearTimeout(C.doubleTapTimer);C.doubleTapTimer=null;if(C.options.onZoomStart){C.options.onZoomStart.call(C,E)}C.zoom(C.pointX,C.pointY,C.scale==1?C.options.doubleTapZoom:1);if(C.options.onZoomEnd){setTimeout(function(){C.options.onZoomEnd.call(C,E)},200)}}else{C.doubleTapTimer=setTimeout(function(){C.doubleTapTimer=null;F=K.target;while(F.nodeType!=1){F=F.parentNode}if(F.tagName!="SELECT"&&F.tagName!="INPUT"&&F.tagName!="TEXTAREA"){J=document.createEvent("MouseEvents");J.initMouseEvent("click",true,true,E.view,1,K.screenX,K.screenY,K.clientX,K.clientY,E.ctrlKey,E.altKey,E.shiftKey,E.metaKey,0,null);J._fake=true;F.dispatchEvent(J)}},C.options.zoom?250:0)}}C._resetPos(200);if(C.options.onTouchEnd){C.options.onTouchEnd.call(C,E)}return}if(B<300&&C.options.momentum){y=G?C._momentum(G-C.startX,B,-C.x,C.scrollerW-C.wrapperW+C.x,C.options.bounce?C.wrapperW:0):y;m=D?C._momentum(D-C.startY,B,-C.y,(C.maxScrollY<0?C.scrollerH-C.wrapperH+C.y-C.minScrollY:0),C.options.bounce?C.wrapperH:0):m;G=C.x+y.dist;D=C.y+m.dist;if((C.x>0&&G>0)||(C.x<C.maxScrollX&&G<C.maxScrollX)){y={dist:0,time:0}}if((C.y>C.minScrollY&&D>C.minScrollY)||(C.y<C.maxScrollY&&D<C.maxScrollY)){m={dist:0,time:0}}}if(y.dist||m.dist){x=r.max(r.max(y.time,m.time),10);if(C.options.snap){I=G-C.absStartX;H=D-C.absStartY;if(r.abs(I)<C.options.snapThreshold&&r.abs(H)<C.options.snapThreshold){C.scrollTo(C.absStartX,C.absStartY,200)}else{A=C._snap(G,D);G=A.x;D=A.y;x=r.max(A.time,x)}}C.scrollTo(d(G),d(D),x);if(C.options.onTouchEnd){C.options.onTouchEnd.call(C,E)}return}if(C.options.snap){I=G-C.absStartX;H=D-C.absStartY;if(r.abs(I)<C.options.snapThreshold&&r.abs(H)<C.options.snapThreshold){C.scrollTo(C.absStartX,C.absStartY,200)}else{A=C._snap(C.x,C.y);if(A.x!=C.x||A.y!=C.y){C.scrollTo(A.x,A.y,A.time)}}if(C.options.onTouchEnd){C.options.onTouchEnd.call(C,E)}return}C._resetPos(200);if(C.options.onTouchEnd){C.options.onTouchEnd.call(C,E)}},_resetPos:function(y){var m=this,z=m.x>=0?0:m.x<m.maxScrollX?m.maxScrollX:m.x,x=m.y>=m.minScrollY||m.maxScrollY>0?m.minScrollY:m.y<m.maxScrollY?m.maxScrollY:m.y;if(z==m.x&&x==m.y){if(m.moved){m.moved=false;if(m.options.onScrollEnd){m.options.onScrollEnd.call(m)}}if(m.hScrollbar&&m.options.hideScrollbar){if(v=="webkit"){m.hScrollbarWrapper.style[v+"TransitionDelay"]="300ms"}m.hScrollbarWrapper.style.opacity="0"}if(m.vScrollbar&&m.options.hideScrollbar){if(v=="webkit"){m.vScrollbarWrapper.style[v+"TransitionDelay"]="300ms"}m.vScrollbarWrapper.style.opacity="0"}return}m.scrollTo(z,x,y||0)},_wheel:function(B){var z=this,A,y,x,m,C;if("wheelDeltaX" in B){A=B.wheelDeltaX/12;y=B.wheelDeltaY/12}else{if("wheelDelta" in B){A=y=B.wheelDelta/12}else{if("detail" in B){A=y=-B.detail*3}else{return}}}if(z.options.wheelAction=="zoom"){C=z.scale*Math.pow(2,1/3*(y?y/Math.abs(y):0));if(C<z.options.zoomMin){C=z.options.zoomMin}if(C>z.options.zoomMax){C=z.options.zoomMax}if(C!=z.scale){if(!z.wheelZoomCount&&z.options.onZoomStart){z.options.onZoomStart.call(z,B)}z.wheelZoomCount++;z.zoom(B.pageX,B.pageY,C,400);setTimeout(function(){z.wheelZoomCount--;if(!z.wheelZoomCount&&z.options.onZoomEnd){z.options.onZoomEnd.call(z,B)}},400)}return}x=z.x+A;m=z.y+y;if(x>0){x=0}else{if(x<z.maxScrollX){x=z.maxScrollX}}if(m>z.minScrollY){m=z.minScrollY}else{if(m<z.maxScrollY){m=z.maxScrollY}}z.scrollTo(x,m,0)},_mouseout:function(x){var m=x.relatedTarget;if(!m){this._end(x);return}while(m=m.parentNode){if(m==this.wrapper){return}}this._end(x)},_transitionEnd:function(x){var m=this;if(x.target!=m.scroller){return}m._unbind("webkitTransitionEnd");m._startAni()},_startAni:function(){var C=this,x=C.x,m=C.y,A=Date.now(),B,z,y;if(C.animating){return}if(!C.steps.length){C._resetPos(400);return}B=C.steps.shift();if(B.x==x&&B.y==m){B.time=0}C.animating=true;C.moved=true;if(C.options.useTransition){C._transitionTime(B.time);C._pos(B.x,B.y);C.animating=false;if(B.time){C._bind("webkitTransitionEnd")}else{C._resetPos(0)}return}y=function(){var D=Date.now(),F,E;if(D>=A+B.time){C._pos(B.x,B.y);C.animating=false;if(C.options.onAnimationEnd){C.options.onAnimationEnd.call(C)}C._startAni();return}D=(D-A)/B.time-1;z=r.sqrt(1-D*D);F=(B.x-x)*z+x;E=(B.y-m)*z+m;C._pos(F,E);if(C.animating){C.aniTime=o(y)}};y()},_transitionTime:function(m){m+="ms";this.scroller.style[v+"TransitionDuration"]=m;if(this.hScrollbar){this.hScrollbarIndicator.style[v+"TransitionDuration"]=m}if(this.vScrollbar){this.vScrollbarIndicator.style[v+"TransitionDuration"]=m}},_momentum:function(D,x,B,m,F){var C=0.0006,y=r.abs(D)/x,z=(y*y)/(2*C),E=0,A=0;if(D>0&&z>B){A=F/(6/(z/y*C));B=B+A;y=y*B/z;z=B}else{if(D<0&&z>m){A=F/(6/(z/y*C));m=m+A;y=y*m/z;z=m}}z=z*(D<0?-1:1);E=y/C;return{dist:z,time:d(E)}},_offset:function(m){var y=-m.offsetLeft,x=-m.offsetTop;while(m=m.offsetParent){y-=m.offsetLeft;x-=m.offsetTop}if(m!=this.wrapper){y*=this.scale;x*=this.scale}return{left:y,top:x}},_snap:function(G,F){var D=this,C,B,E,A,z,m;E=D.pagesX.length-1;for(C=0,B=D.pagesX.length;C<B;C++){if(G>=D.pagesX[C]){E=C;break}}if(E==D.currPageX&&E>0&&D.dirX<0){E--}G=D.pagesX[E];z=r.abs(G-D.pagesX[D.currPageX]);z=z?r.abs(D.x-G)/z*500:0;D.currPageX=E;E=D.pagesY.length-1;for(C=0;C<E;C++){if(F>=D.pagesY[C]){E=C;break}}if(E==D.currPageY&&E>0&&D.dirY<0){E--}F=D.pagesY[E];m=r.abs(F-D.pagesY[D.currPageY]);m=m?r.abs(D.y-F)/m*500:0;D.currPageY=E;A=d(r.max(z,m))||200;return{x:G,y:F,time:A}},_bind:function(y,x,m){(x||this.scroller).addEventListener(y,this,!!m)},_unbind:function(y,x,m){(x||this.scroller).removeEventListener(y,this,!!m)},destroy:function(){var m=this;m.scroller.style[v+"Transform"]="";m.hScrollbar=false;m.vScrollbar=false;m._scrollbar("h");m._scrollbar("v");m._unbind(h,window);m._unbind(b);m._unbind(p);m._unbind(e);m._unbind(t);if(!m.options.hasTouch){m._unbind("mouseout",m.wrapper);m._unbind(q)}if(m.options.useTransition){m._unbind("webkitTransitionEnd")}if(m.options.checkDOMChanges){clearInterval(m.checkDOMTime)}if(m.options.onDestroy){m.options.onDestroy.call(m)}},refresh:function(){var z=this,B,y,m,x,C=0,A=0;if(z.scale<z.options.zoomMin){z.scale=z.options.zoomMin}z.wrapperW=z.wrapper.clientWidth||1;z.wrapperH=z.wrapper.clientHeight||1;z.minScrollY=-z.options.topOffset||0;z.scrollerW=d(z.scroller.offsetWidth*z.scale);z.scrollerH=d((z.scroller.offsetHeight+z.minScrollY)*z.scale);z.maxScrollX=z.wrapperW-z.scrollerW;z.maxScrollY=z.wrapperH-z.scrollerH+z.minScrollY;z.dirX=0;z.dirY=0;if(z.options.onRefresh){z.options.onRefresh.call(z)}z.hScroll=z.options.hScroll&&z.maxScrollX<0;z.vScroll=z.options.vScroll&&(!z.options.bounceLock&&!z.hScroll||z.scrollerH>z.wrapperH);z.hScrollbar=z.hScroll&&z.options.hScrollbar;z.vScrollbar=z.vScroll&&z.options.vScrollbar&&z.scrollerH>z.wrapperH;B=z._offset(z.wrapper);z.wrapperOffsetLeft=-B.left;z.wrapperOffsetTop=-B.top;if(typeof z.options.snap=="string"){z.pagesX=[];z.pagesY=[];x=z.scroller.querySelectorAll(z.options.snap);for(y=0,m=x.length;y<m;y++){C=z._offset(x[y]);C.left+=z.wrapperOffsetLeft;C.top+=z.wrapperOffsetTop;z.pagesX[y]=C.left<z.maxScrollX?z.maxScrollX:C.left*z.scale;z.pagesY[y]=C.top<z.maxScrollY?z.maxScrollY:C.top*z.scale}}else{if(z.options.snap){z.pagesX=[];while(C>=z.maxScrollX){z.pagesX[A]=C;C=C-z.wrapperW;A++}if(z.maxScrollX%z.wrapperW){z.pagesX[z.pagesX.length]=z.maxScrollX-z.pagesX[z.pagesX.length-1]+z.pagesX[z.pagesX.length-1]}C=0;A=0;z.pagesY=[];while(C>=z.maxScrollY){z.pagesY[A]=C;C=C-z.wrapperH;A++}if(z.maxScrollY%z.wrapperH){z.pagesY[z.pagesY.length]=z.maxScrollY-z.pagesY[z.pagesY.length-1]+z.pagesY[z.pagesY.length-1]}}}z._scrollbar("h");z._scrollbar("v");if(!z.zoomed){z.scroller.style[v+"TransitionDuration"]="0";z._resetPos(200)}},scrollTo:function(m,F,E,D){var C=this,B=m,A,z;C.stop();if(!B.length){B=[{x:m,y:F,time:E,relative:D}]}for(A=0,z=B.length;A<z;A++){if(B[A].relative){B[A].x=C.x-B[A].x;B[A].y=C.y-B[A].y}C.steps.push({x:B[A].x,y:B[A].y,time:B[A].time||0})}C._startAni()},scrollToElement:function(m,y){var x=this,z;m=m.nodeType?m:x.scroller.querySelector(m);if(!m){return}z=x._offset(m);z.left+=x.wrapperOffsetLeft;z.top+=x.wrapperOffsetTop;z.left=z.left>0?0:z.left<x.maxScrollX?x.maxScrollX:z.left;z.top=z.top>x.minScrollY?x.minScrollY:z.top<x.maxScrollY?x.maxScrollY:z.top;y=y===undefined?r.max(r.abs(z.left)*2,r.abs(z.top)*2):y;x.scrollTo(z.left,z.top,y)},scrollToPage:function(A,z,C){var B=this,m,D;C=C===undefined?400:C;if(B.options.onScrollStart){B.options.onScrollStart.call(B)}if(B.options.snap){A=A=="next"?B.currPageX+1:A=="prev"?B.currPageX-1:A;z=z=="next"?B.currPageY+1:z=="prev"?B.currPageY-1:z;A=A<0?0:A>B.pagesX.length-1?B.pagesX.length-1:A;z=z<0?0:z>B.pagesY.length-1?B.pagesY.length-1:z;B.currPageX=A;B.currPageY=z;m=B.pagesX[A];D=B.pagesY[z]}else{m=-B.wrapperW*A;D=-B.wrapperH*z;if(m<B.maxScrollX){m=B.maxScrollX}if(D<B.maxScrollY){D=B.maxScrollY}}B.scrollTo(m,D,C)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(p);this._unbind(e);this._unbind(t)},enable:function(){this.enabled=true},stop:function(){if(this.options.useTransition){this._unbind("webkitTransitionEnd")}else{l(this.aniTime)}this.steps=[];this.moved=false;this.animating=false},zoom:function(m,D,C,B){var z=this,A=C/z.scale;if(!z.options.useTransform){return}z.zoomed=true;B=B===undefined?200:B;m=m-z.wrapperOffsetLeft-z.x;D=D-z.wrapperOffsetTop-z.y;z.x=m-m*A+z.x;z.y=D-D*A+z.y;z.scale=C;z.refresh();z.x=z.x>0?0:z.x<z.maxScrollX?z.maxScrollX:z.x;z.y=z.y>z.minScrollY?z.minScrollY:z.y<z.maxScrollY?z.maxScrollY:z.y;z.scroller.style[v+"TransitionDuration"]=B+"ms";z.scroller.style[v+"Transform"]=a+z.x+"px,"+z.y+"px"+j+" scale("+C+")";z.zoomed=false},isReady:function(){return !this.moved&&!this.zoomed&&!this.animating}};if(typeof exports!=="undefined"){exports.iScroll=s}else{window.iScroll=s}})();var pline,oo;oo=pline=(function(e){var p={templateEngine:"mustache",viewportSelector:"body",pushState:false,scroll:"iscroll"};return{_ajaxRequestObject:null,Class:function s(){return my.Class.apply(this,arguments)},log:function d(A){if(e.console&&e.console.log){var B=("string"!==typeof A&&"toString" in A)?A.toString():A;console.log(A.toStirng())}},warn:function w(A){var B=("string"!==typeof A&&"toString" in A)?A.toString():A;if(e.console&&e.console.warn){console.warn(B)}else{oo.log("/!\\ Warning : "+B)}},getNS:function j(D,E){var F=D.split(".");var C=e;for(var B=0,A=F.length;B<A;B++){if("object"!=typeof(C[F[B]])){C[F[B]]={}}C=C[F[B]]}return C},createDelegate:function f(B,A){return function(){return B.apply(A,arguments)}},emptyFn:function n(){},generateId:function u(B){var A=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return["id-",A()+A()+"-"+A()+"-"+A()+"-"+A()+"-"+A()+A()+A()].join("")},override:function g(B,A){var C=Object.getOwnPropertyNames(A);C.forEach(function(D){var E=Object.getOwnPropertyDescriptor(A,D);Object.defineProperty(B,D,E)});return B},createController:function m(B,C){if(1===arguments.length){C=B;B=null}if(!C&&("object"!==typeof C)){throw new Error("Wrong parameter")}var A=C.constructor=function(){A.Super.call(this)};var D=oo.Class(oo.router.Controller,C);if(B){this.getRouter().addController(B,D)}return D},getRouter:function z(){return oo.router.router||(oo.router.router=new oo.router.Router())},initViewport:function q(B){var C=this.getNS("oo.view"),A=C.viewport=new C.Viewport(B);return A},getViewport:function t(){var A=this.getNS("oo.view");if(A.viewport){return A.viewport}else{return this.initViewport()}},createPanelClass:function y(B,E){if(!(typeof B=="object"&&"id" in B)){throw"Wrong parameter"}var D=B.id;delete B.id;var A=B.constructor=function(){A.Super.call(this)};var C=oo.Class(oo.view.Panel,B);if(E!==false){E||(E={});oo.getViewport().register(D,C,E.stage||null,E.pos||null)}return C},createPanel:function x(A,B){console.warn("This method is deprecated, use oo.createPanelClass() instead");return this.createPanelClass.apply(this,arguments)},createModel:function k(B){var A=new oo.data.Model(B);oo.data.Model.register(A);return A},getModel:function l(A){return oo.data.Model.get(A)},createElement:function o(B,A){return new (oo.view.Element.get(B))(A||null)},define:function b(A){this.override(p,A)},getConfig:function v(A){if(A&&A in p){return p[A]}else{return p}},bootstrap:function a(A){if(typeof A!=="function"){throw"parameter must be a function"}var C=this;function B(){e.scroll(0,0);document.addEventListener("touchmove",function(D){D.preventDefault()},false);A.call(e,C)}if("PhoneGap" in e&&PhoneGap.available){document.addEventListener("deviceready",B)}else{e.addEventListener("load",B)}},ajax:function i(C,F,E,A,B){if(0===arguments.length){return{post:function(I,J,G,H){oo.ajax(I,"post",J,G,H)},get:function(I,J,G,H){oo.ajax(I,"get",J,G,H)}}}if(null===this._ajaxRequestObject){this._ajaxRequestObject=new oo.core.net.Ajax()}var D=this._ajaxRequestObject.buildReq(C,F,E,A,B);D.send()},_convertNodeListToArray:function c(A){return Array.prototype.slice.call(A,0)},serialize:function r(A){var B=[];for(var C in A){B.push(C+"="+encodeURI((typeof A[C]=="object"?A[C].toString():A[C])))}return B.join("&")},isArray:function h(B){var A=Array.isArray;if(A){return A(B)}else{return B.prototype.toString()==="[object Array]"}}}})(window);(function(a){var b=a.getNS("oo.core.mixins").Events=a.Class({_getListenersArray:function c(){if(!this._eventListeners){this._eventListeners={}}return this._eventListeners},addListener:function d(h,i){if("function"!==typeof i){throw"listener must be a function"}var g=this._getListenersArray();if(!g[h]){g[h]=[]}g[h].push(i)},removeListener:function e(h,j){if("function"!==typeof j){throw"listener must be a function"}var g=this._getListenersArray();if(g[h]){var i=g[h].indexOf(j);if(-1!=i){g[h].splice(i,1)}}},triggerEvent:function f(j,n){var h=this._getListenersArray();if(h[j]){for(var k=0,g=h[j].length;k<g;k++){var m=h[j][k];m.apply(this,n)}}}})})(oo||{});(function(a){var c=this;var e=a.getNS("oo.core.mixins").Scroll=a.Class({isScrollable:false,_createScroll:function d(f){if(null===this.scroll){if(undefined===f){f={}}if(!f.hasOwnProperty("el")){f.el=this}return new (a.view.scroll.Scroll.get(a.getConfig("scroll")))(f)}},setScrollable:function b(f){this.scroll=null;this.scroll=this._createScroll(f);var g=this;this.addListener(a.view.Element.REFRESH_CONTENT,function(){g.scroll.refresh()});this.isScrollable=true}})})(oo||{});(function(a){var h="ontouchstart" in window?true:false;var g=function g(j,i){var k=null;if(e.HAS_TOUCH){i=i||0;k=j.touches[i];if(undefined===k){k=j.changedTouches[i]}}else{k=j}return[parseInt(k.pageX,10),parseInt(k.pageY,10)]};var e=a.Class({STATIC:{getPosition:g,getPositionX:function d(j,i){return g(j,i)[0]},getPositionY:function c(j,i){return g(j,i)[1]},getTarget:function f(j,i){return j.touches[i||0].target},HAS_TOUCH:"ontouchstart" in window?true:false}});if(!e.HAS_TOUCH){e.EVENT_START="mousedown";e.EVENT_MOVE="mousemove";e.EVENT_END="mouseup"}else{e.EVENT_START="touchstart";e.EVENT_MOVE="touchmove";e.EVENT_END="touchend"}var b=a.getNS("oo.core");b.Touch=e})(oo||{});(function(a){var g=this;var e=a.getNS("oo.core.net").Ajax=a.Class({buildReq:function d(i,h,n,j,o){var p=this._getRequest();h=h.toUpperCase();p.addEventListener("readystatechange",function(q){if(q.target.readyState==4){if(q.target.status==200){var r=JSON.parse(q.target.responseText);j.call(g,r)}else{o.call(g)}}});var l=this._processParams(n),k=i;if(h=="GET"&&""!==l){if(k.indexOf("?")===-1){k+=("?"+l)}else{k+=("&"+l)}}p.open(h,k);if("POST"==h){this._setPostHeaders(p)}return{send:function m(){if("POST"===h){p.send(l)}else{p.send()}}}},_getRequest:function f(){return new XMLHttpRequest()},_processParams:function b(h){return a.serialize(h)},_setPostHeaders:function c(h){h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.setRequestHeader("Content-type","application/x-www-form-urlencoded")}})})(oo);(function(i){var c=i.core.Touch;var h=i.getNS("oo.core").Gesture=i.Class({constructor:function d(){var m=this;document.addEventListener(c.EVENT_START,function(n){m.startGesture(n)},false);document.addEventListener(c.EVENT_MOVE,function(n){n.preventDefault();m.moveGesture(n)},false);document.addEventListener(c.EVENT_END,function(n){m.stopGesture(n)},false)},getPos:function f(n){var m={x:null,y:null};if(c.HAS_TOUCH){if(event.touches.length==1){m.x=event.touches[0].pageX;m.y=event.touches[0].pageY}}else{m.x=event.pageX;m.y=event.pageY}return m},getXPos:function g(m){var n=this.getPos(m);return n.x},getYPos:function b(m){var n=this.getPos(m);return n.y},touchFlags:{el:null,startTime:null,stopTime:null,hasMoved:false,startX:null,startY:null,lastX:null,lastY:null,time:150,timeout:null,doubleTap:false},startGesture:function e(m){this.touchFlags.el=m.target;this.touchFlags.startTime=Date.now();this.touchFlags.hasMoved=false;this.touchFlags.startX=this.getXPos(m);this.touchFlags.startY=this.getYPos(m);if((this.touchFlags.startTime-this.touchFlags.stopTime)<this.touchFlags.time){this.touchFlags.doubleTap=true;window.clearTimeout(this.touchFlags.timeout)}else{this.touchFlags.doubleTap=false}},moveGesture:function j(m){if(this.touchFlags.startTime){this.touchFlags.lastX=this.getXPos(m);this.touchFlags.lastY=this.getYPos(m);this.touchFlags.hasMoved=true}},stopGesture:function a(p){var o=this;this.touchFlags.stopTime=Date.now();if(this.touchFlags.hasMoved){var n=this.touchFlags.lastX-this.touchFlags.startX,m=this.touchFlags.lastY-this.touchFlags.startY;if(Math.abs(n)>30&&Math.abs(m)<100){if(n<0){this.fireEvent(o.touchFlags.el,"swipeLeft",true,true)}else{this.fireEvent(o.touchFlags.el,"swipeRight",true,true)}}}else{o.touchFlags.timeout=window.setTimeout(function(){o.touchFlags.timeout=null;if(o.touchFlags.doubleTap){o.fireEvent(o.touchFlags.el,"doubleTap",true,true)}else{o.fireEvent(o.touchFlags.el,"tap",true,true)}},this.touchFlags.time)}o.touchFlags.lastX=o.touchFlags.lastY=o.touchFlags.startX=o.touchFlags.startY=null},fireEvent:function l(q,p,o,n){var m=document.createEvent("Events");m.initEvent(p,o,n);q.dispatchEvent(m)}});var k=new h();i.getNS("oo.core").gesture=k})(oo||{});(function(a){var d=a.getNS("oo.router").Controller=a.Class({_controllers:{},_viewport:null,constructor:function b(){this._viewport=a.getViewport()},getViewport:function c(){return a.getViewport()}})})(oo||{});(function(i){var c=i.getNS("oo.router").Router=i.Class({constructor:function f(){this._routes={};this._registeredControllers={};this._controllers={};var p=this},_usePushState:function m(){return i.getConfig("pushState")},addRoutes:function d(p){if(!p||(Object.prototype.toString.call(p)!=="[object Object]")){throw new Error("Routes must exist and must be an object literal")}for(var q in p){this.addRoute(q,p[q])}},addRoute:function b(p,q){if(!p||!q.hasOwnProperty("url")||!q.hasOwnProperty("controller")||!q.hasOwnProperty("action")){throw new Error('A route must have a name and properties "url", "controller" and "action"')}if(!this.isValidUrl(q.url)){throw new Error('The url property must begun by "/"')}var s={};s[p]=q;this._routes=i.override(this._routes,s);delete s[p]},isValidUrl:function o(p){return("/"===p.slice(0,1))},addController:function k(q,p){if(!q||("string"!==typeof q)){throw new Error('Wrong "name" parameter : Must exist and be a string')}if("function"!==typeof p){throw new Error('Wrong "cls" parameter : Must be a function')}var r={};r[q]=p;this._controllers=i.override(this._controllers,r)},addControllers:function e(p){if(!p||(Object.prototype.toString.call(p)!=="[object Object]")){throw new Error("Wrong parameter : must exist and be an object")}for(var q in p){this.addController(q,p[q])}},init:function n(){var p=this,r=window.location,q=false;var s=function s(t){p.dispatch(t)};if(this._usePushState()&&window.history&&window.history.pushState){this.hasHistory=true;window.addEventListener("popstate",function(t){q=true;s(r.pathname)});window.setTimeout(function(){if(!q){p.dispatch(r.pathname)}},1)}else{window.addEventListener("hashchange",function(t){s(r.hash.slice(1))},false);s(r.hash.slice(1))}},load:function l(p){if(!this._usePushState()||!this.hasHistory){window.location.hash=p}else{history.pushState({},"",p)}},dispatch:function j(s){this.parseRoute(s);if(this.requestParams){var r=[this.requestParams.controller.charAt(0).toUpperCase(),this.requestParams.controller.substring(1),"Controller"].join("");var p=[this.requestParams.action,"Action"].join("");var q;if((typeof this._registeredControllers[r]!=="function")&&("undefined"!==typeof this._controllers[r])){if("undefined"===typeof this._registeredControllers[r]){this._registeredControllers[r]=new this._controllers[r]()}q=this._registeredControllers[r];if(typeof q[p]==="function"){q[p](this.requestParams.params)}}}},parseRoute:function h(q){var p=this._routes;var s=null;for(var u in p){var t=p[u];if(t.url==q.substring(0,t.url.length)){s={controller:t.controller,action:t.action};q=q.substring(t.url.length)}}if("/"==q.substring(0,1)){q=q.slice(1)}var v=q.split("/");if(!s){s={controller:v[0],action:v[1]};if(!s.controller){s.controller="index"}else{v.shift()}if(!s.action||s.action===undefined){s.action="index"}else{v.shift()}}s.params={};while(v.length){paramName=v.shift();if(paramName){paramValue=v.shift();if(paramValue!==undefined){s.params[paramName]=paramValue}}}this.requestParams=s;return s},url:function a(p,t){var q=this._routes[p];if(!q){throw Error("route name doesn't exists")}var r="";for(var s in t){r=[r,"/",s,"/",t[s]].join("")}return[q.url,r].join("")},back:function g(){history.back()}})})(oo||{});var oo=(function(a){var e=this;var f=a.getNS("oo.data");var d={};f.Provider=a.Class({STATIC:{register:function c(g,h){if(d[h]){throw"Already existing codename"}d[h]=g},get:function b(g){if(g in d){return d[g]}else{throw"Invalid codename for a provider"}},unregister:function c(g){delete d[g]}},_name:"",_data:{},constructor:function(g){if(g&&"name" in g&&typeof g.name=="string"){this._name=g.name}else{throw"Config object must contain a name property"}},save:function(g){throw"Can't be called directly from Provider class"},fetch:function(g){throw"Can't be called directly from Provider class"},get:function(g){throw"Can't be called directly from Provider class"},clearAll:function(g){throw"Can't be called directly from Provider class"},remove:function(g,h){throw"Can't be called directly from Provider class"}});return a})(oo||{});(function(g){var b=this;var e=g.getNS("oo.data").MemoryProvider=g.Class(g.data.Provider,{_data:{},constructor:function f(j){e.Super.call(this,j);if(j.hasOwnProperty("data")){this.setData(j.data)}},save:function h(l,k){this.setData(l);var m={success:g.emptyFn};k=k||{};if(typeof k=="function"){k={success:k}}var j=g.override(m,k);k.success.call(b,l)},fetch:function a(k){var l={success:g.emptyFn};k=k||{};if(typeof k=="function"){k={success:k}}var j=g.override(l,k);j.success.call(b,this._data)},get:function c(j,k){k.call(b,this._data[j]||null)},setData:function i(k,j){if(!k){throw new Error("Data missing")}if(!(k instanceof Array)){k=[k]}if(j){this.clearAll()}this._data=k},clearAll:function d(){this._data={}}});g.data.Provider.register(e,"memory")})(oo||{});(function(h){var b=this;var c=h.getNS("oo.data").LocalProvider=h.Class(h.data.Provider,{_store:{},constructor:function g(j){c.Super.call(this,j);this._store=Lawnchair({name:this._name,record:"record"},function(){})},save:function i(l,k){if(!(l instanceof Array)){l=[l]}var m={success:h.emptyFn};if(typeof k=="function"){k={success:k}}var j=h.override(m,k);this._store.batch(l);j.success.call(b,l)},fetch:function a(k){var l={success:h.emptyFn};if(typeof k=="function"){k={success:k}}var j=h.override(l,k);this._store.all(function(m){j.success.call(b,m)})},get:function d(j,k){this._store.get(j,k)},remove:function e(k,o){if(!h.isArray(k)){k=[k]}var m=this,l=0,n=k.length,j=function(){l++;if(l==n){o()}};k.forEach(function(p){m._store.remove(p,j)})},clearAll:function f(){this._store.nuke()}});h.data.Provider.register(c,"local")})(oo||{});(function(g){var b=this;var l=g.getNS("oo.data").AjaxProvider=g.Class(g.data.Provider,{_cacheProvider:null,_cacheCleared:true,_cachedParameterString:[],_url:null,_cachePrefix:"",_noCache:null,constructor:function e(m){var o={cacheProvider:"memory",noCache:false};var n=g.override(o,m);if(!n.url||typeof n.url!="string"){throw"'url' property must be set"}this._url=n.url;l.Super.call(this,{name:n.name});this._noCache=n.noCache;if(!this._noCache){this._cacheProvider=new (g.data.Provider.get(n.cacheProvider))({name:"yellowjs-cache__"+n.name});this._cachePrefix=this._url}},save:function h(o,n){var q="POST";var p={success:g.emptyFn,error:g.emptyFn};if(typeof n=="function"){n={success:n}}var m=g.override(p,n);g.ajax().post(this._url,o,g.createDelegate(function(){if(!this._noCache){this._clearCache()}m.success.call(b)},this),m.error)},fetch:function a(n,o){var r="GET";var p={success:g.emptyFn,error:g.emptyFn,params:{}};n=n||{};if(typeof n=="function"){n={success:n}}var m=g.override(p,n);var q=g.createDelegate(function(s){var t=g.serialize(m.params);if(!this._noCache){this._clearCache(t);this._saveCache(s,t,function(){m.success.call(b,s)})}else{m.success.call(b,s)}},this);if(o||this._noCache||!this._getCache(g.serialize(m.params),q)){g.ajax().get(this._url,m.params,q,m.error)}},get:function d(m,q){if(this._noCache){throw"This method is available only if cache is activated"}var n=this;var p=m||(this._cachedParameterString[this._cachedParameterString.length-1]);var o=p.substr(p.indexOf("|")+1);if(this._getCache(o,g.emptyFn)){n._cacheProvider.get(p,function(r){q.call(b,r.data)})}else{throw"please perform a fetch before"}},clearAll:function f(){if(this._noCache){throw"This method is available only if cache is activated"}this._clearCache()},_genCacheKey:function j(m){return this._cachePrefix+"|"+(m||"")},_clearCache:function k(m){if(this._noCache){throw"This method is available only if cache is activated"}if(!m){this._cacheProvider.clearAll();this._cachedParameterString=[]}else{this._cachedParameterString.slice(this._cachedParameterString.indexOf(this._genCacheKey(m)),1)}},_saveCache:function c(o,n,p){if(this._noCache){throw"This method is available only if cache is activated"}var m={};m.key=this._genCacheKey(n);m.data=o;this._cacheProvider.save(m,p);if(-1===this._cachedParameterString.indexOf(m.key)){this._cachedParameterString.push(m.key)}},_getCache:function i(m,n){if(this._noCache){throw"This method is available only if cache is activated"}if(-1!==this._cachedParameterString.indexOf(this._genCacheKey(m))){this._cacheProvider.fetch(function(o){n(o.data)});return true}else{return false}}});g.data.Provider.register(l,"ajax")})(oo||{});(function(g){var z=g.data.Provider,s=this;var m={};var h=g.getNS("oo.data").Model=g.Class(null,g.core.mixins.Events,{STATIC:{AFTER_COMMIT:"AFTER_COMMIT",AFTER_SAVE:"AFTER_COMMIT",AFTER_FETCH:"AFTER_FETCH",register:function b(D){if(!m.hasOwnProperty(D._name)){m[D._name]=D}else{throw"Model already exists in registry"}},unregister:function b(D){if(!m.hasOwnProperty(D)){throw"No model registred with the given id"}else{m[D]=null;delete m[D]}},get:function y(D){if(!m.hasOwnProperty(D)){throw"No model registred with the given id"}else{return m[D]}}},_data:null,_indexes:null,_toBeDeleted:null,constructor:function v(E){if(!E||(!E.hasOwnProperty("name")||!E.hasOwnProperty("provider"))){throw'Either property "name" or "provider" is missing in the options given to the Model constructor'}var F={indexes:["key"]};var D=g.override(F,E);this._data=[];this._indexes={};this._toBeDeleted=[];this.setModelName(D.name);this.setProvider(D.provider);this.setIndexes(D.indexes)},setProvider:function c(D){if(D instanceof z){this._provider=D}else{if(typeof D=="object"){var E=g.data.Provider.get(D.type);delete D.type;D.name=this._name;this._provider=new E(D)}}},getModelName:function w(){return this._name},setModelName:function x(D){if(!D||"string"!==typeof D){throw new Error("Missing name or name is not a string")}this._name=D},setIndexes:function f(D){D.forEach(function(E){this._indexes[E]={}},this);this._buildFullIndexes()},_resetIndexes:function t(){var D=Object.getOwnPropertyNames(this._indexes);this.setIndexes(D)},_buildIndex:function C(D){var E=Object.getOwnPropertyNames(this._indexes);E.forEach(function(F){if(D[F]){if(!this._indexes[F][D[F]]){this._indexes[F][D[F]]=[]}this._indexes[F][D[F]].push(D)}},this)},_removeFromIndex:function i(D){var E=Object.getOwnPropertyNames(this._indexes);E.forEach(function(F){if(D[F]){this._indexes[F][D[F]].splice(this._indexes[F][D[F]].indexOf(D),1);if(0===this._indexes[F][D[F]].length){this._indexes[F][D[F]]=null;delete this._indexes[F][D[F]]}}},this)},_createIndexes:function k(){return r()},_buildFullIndexes:function r(){this._data.forEach(function(D){this._buildIndex(D)},this)},fetch:function p(H,E){var G={success:g.emptyFn,params:{}};H=H||{};if(typeof H=="function"){H={success:H}}if(typeof H!="object"){throw"Model.fetch() : params must be a function or a config object"}H=g.override(G,H);var F=this,D=function D(I){if(I){if(!E){F.clearAll()}F.setData(I)}if(H.success){H.success.call(F)}F.triggerEvent(h.AFTER_FETCH,[F])};this._provider.fetch({success:D,params:H.params})},save:function u(D){this.commit(D)},commit:function e(E){var D=this;E=E||g.emptyFn;this._provider.save(this._data,function(){if(D._toBeDeleted.length){D._provider.remove(D._toBeDeleted,function(){D._toBeDeleted=[];D.triggerEvent(h.AFTER_COMMIT);E.call(D)})}})},getData:function j(){return this._data},setData:function d(D){D.forEach(this.set,this)},clearAll:function a(){this._data=[];this._resetIndexes()},filterBy:function B(F,G){if(undefined===F||undefined===G){throw new Error("Missing params index or key")}if("string"!==typeof F){throw new Error("Param index must be a string")}var E=this._indexes,D=[],H;if(E.hasOwnProperty(F)){H=E[F][G];if(undefined!==H){D=H}}else{this._data.forEach(function(I){if(I.hasOwnProperty(F)){if(I[F]==G){D.push(I)}}})}return D},getBy:function q(E,F){var D=this.filterBy(E,F);if(D.length){return D[0]}else{return null}},get:function y(D){if(undefined===D||"object"===typeof D){throw new Error("Missing key or key must't be an object")}return this.getBy("key",D)},set:function l(D){if(undefined===D||"object"!==typeof D){throw new Error("Parameter must exist and be an object")}var E=null;if(D.hasOwnProperty("key")){E=this.get(D.key)}if(null===E){this.add(D)}else{this._removeFromIndex(E);E=g.override(E,D);this._buildIndex(E)}},add:function n(D){if(!D.hasOwnProperty("key")){D.key=g.generateId()}else{if(null!==this.get(D.key)){throw"Trying to add a record with an already existing id"}}this._data.push(D);this._buildIndex(D)},removeBy:function o(D,E){var F=this.filterBy(D,E);F.forEach(function(G){this._removeFromIndex(G);this._data.splice(this._data.indexOf(G),1);this._toBeDeleted.push(G.key)},this)},remove:function A(D){return this.removeBy("key",D)}})})(oo||{});var oo=(function(b){var f=this;var g=b.getNS("oo.view.templateengine");var a={};var e=g.Template=b.Class({STATIC:{register:function d(h,i){if(a[i]){throw"Already existing codename"}a[i]=h},get:function c(h){if(h in a){return a[h]}else{throw"Invalid codename"}},unregister:function d(h){delete a[h]}},constructor:function(h){},render:function(i,h){throw"Can't be called directly from Template class"}});return b})(oo||{});var oo=(function(a){var c=this;var d=a.getNS("oo.view.templateengine");var b=d.TemplateEngineMustache=a.Class(a.view.templateengine.Template,{constructor:function(e){b.Super.call(this,e)},render:function(f,e){if(!e&&!f){throw new Error("datas, tpl and domElem must exist")}return Mustache.render(f,e)}});d.Template.register(b,"mustache");return a})(oo||{});var oo=(function(a){var b=this;var d=a.getNS("oo.view.templateengine");var c=d.TemplateEngineHandlebars=a.Class(a.view.templateengine.Template,{constructor:function(e){c.Super.call(this,e)},render:function(f,e){if(!e&&!f){throw new Error("datas, tpl and domElem must exist")}var g=Handlebars.compile(f);return g(e)}});d.Template.register(c,"handlebars");return a})(oo||{});(function(oo){var ClassList=oo.Class({constructor:function constructor(obj){this._dom=obj;this._list=(obj.getAttribute("class"))?obj.getAttribute("class").split(" "):[]},destroy:function destroy(){this._dom=null;this._list.splice(0);this._list=null},_updateClassList:function _updateClassList(){this._dom.setAttribute("class",this._list.join(" "))},removeClass:function removeClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}var updated=false;var that=this;this._list=this._getDomCls();clsName.forEach(function(element,index,array){var i=that._list.indexOf(element);if(-1!==i){that._list.splice(i,1);updated=true}});if(updated){this._updateClassList()}},addClass:function addClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}var that=this;this._list=this._getDomCls();clsName.forEach(function(cls){if(!that.hasClass(cls)){that._list.push(cls);that._updateClassList()}})},setClass:function setClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}this._list=clsName;this._updateClassList()},hasClass:function hasClass(clsName){var i=this._getDomCls().indexOf(clsName);if(-1===i){return false}else{return true}},getClasses:function getClasses(){return this._list},_getDomCls:function _getDomCls(){var cls=this._dom.getAttribute("class");return((cls)?cls.split(" "):[])}});var prop={readOnly:[],readWrite:["width","height","zIndex","display","top","right","bottom","left","opacity","webkitTransitionProperty","webkitTransitionTimingFunction","webkitTransitionDuration","webkitTransitionDelay"]};var Dom=oo.getNS("oo.view").Dom=oo.Class(oo.emptyFn,oo.core.mixins.Events,{STATIC:{CSSMATRIXPATTERN:/matrix\(1, 0, 0, 1, (-?[0-9.]+), (-?[0-9.]+)\)/,createElement:function createElement(tag){return new Dom(document.createElement(tag))}},constructor:function constructor(identifier){this._dom=null;this._cached={};this._template=null;this._cacheTpl=null;if(typeof identifier=="string"){this._identifier=identifier}else{if(identifier instanceof Object){this.setDomObject(identifier)}else{throw"Fatal Error : No identifier !"}}this.generateAccessor()},destroy:function destroy(){this.classList.destroy();this.classList=null;this._cached.splice(0);this._cached=null;this._dom.removeEventListeners();document.removeElement(this._dom);this._dom=null},generateAccessor:function generateAccessor(){var p=this,i,len;for(i=0,len=prop.readOnly.length;i<len;i++){eval(["p.get",prop.readOnly[i].charAt(0).toUpperCase(),prop.readOnly[i].slice(1)," = function (unit, noCache) { if (noCache || !this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')]) { this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')] = (unit ? window.getComputedStyle(this.getDomObject()).",prop.readOnly[i]," : (window.getComputedStyle(this.getDomObject()).",prop.readOnly[i],").replace(/s|ms|px|em|pt|%/, '')); this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')] = parseInt(this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')], 10) || this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')]; } return this._cached[['",prop.readOnly[i],"', (unit ? 'u' : '')].join('')]; };"].join(""))}for(i=0,len=prop.readWrite.length;i<len;i++){eval(["p.get",prop.readWrite[i].charAt(0).toUpperCase(),prop.readWrite[i].slice(1)," = function (unit, noCache) { if (noCache || !this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')]) { this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')] = (unit ? window.getComputedStyle(this.getDomObject()).",prop.readWrite[i]," : (window.getComputedStyle(this.getDomObject()).",prop.readWrite[i],").replace(/s|ms|px|em|pt|%/, '')); this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')] = parseInt(this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')], 10) || this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')]; } return this._cached[['",prop.readWrite[i],"', (unit ? 'u' : '')].join('')]; };"].join(""));eval(["p.set",prop.readWrite[i].charAt(0).toUpperCase(),prop.readWrite[i].slice(1)," = function (val, unit) { if (this._cached['",prop.readWrite[i],"'] || this._cached[['",prop.readWrite[i],"', 'u'].join('')]) { this._cached['",prop.readWrite[i],"'] = this._cached[['",prop.readWrite[i],"', 'u'].join('')] = null; } this.getDomObject().style.",prop.readWrite[i]," = [val, (undefined !== unit ? unit : '')].join(''); return this };"].join(""))}},getTranslations:function getTranslations(noCache){if(!this._cached.webkitTranslations||noCache){var values=this.getWebkitTransform().match(Dom.CSSMATRIXPATTERN);if(null===values){values=[0,0,0]}this._cached.webkitTranslations=[parseInt(values[1],10),parseInt(values[2],10)]}return this._cached.webkitTranslations},getWebkitTransform:function getWebkitTransform(noCache){if(!this._cached.webkitTransform||noCache){this._cached.webkitTransform=window.getComputedStyle(this.getDomObject()).webkitTransform}return this._cached.webkitTransform},setWebkitTransform:function setWebkitTransform(value){if(this._cached.webkitTransform||this._cached.webkitTranslations){this._cached.webkitTransform=null;this._cached.webkitTranslations=null}this.getDomObject().style.webkitTransform=value;return this},setTranslations:function setTranslations(x,y,unit){unit=unit||"px";this.setWebkitTransform(["translate3d(",x,unit,", ",y,unit,", 0)"].join(""));return this},getTranslateX:function getTranslateX(unit,noCache){return(unit?[this.getTranslations(noCache)[0],"px"].join(""):this.getTranslations(noCache)[0])},getTranslateY:function getTranslateY(unit,noCache){return(unit?[this.getTranslations(noCache)[1],"px"].join(""):this.getTranslations(noCache)[1])},setTranslateX:function setTranslateX(val){var valY=this.getTranslateY();this.setTranslations(val,valY);return this},setTranslateY:function setTranslateY(val){var valX=this.getTranslateX();this.setTranslations(valX,val);return this},setDomObject:function setDomObject(domNode){if(typeof domNode=="string"){var n=document.querySelector(domNode);if(null===n){throw"Invalid selector node doesn't exists"}domNode=n}this._dom=domNode;if(domNode&&(!("id" in domNode)||domNode.id==="")){this._dom.id=oo.generateId(this._dom.tagName)}this.classList=new ClassList(this.getDomObject());return this},getDomObject:function getDomObject(){if(!this._dom){this.setDomObject(this._identifier)}return this._dom},find:function find(selector,returnDom){var n=this.getDomObject().querySelector(selector);if(null===n){return null}else{return(!returnDom)?new Dom(n):n}},findAll:function findAll(selector,returnDom){var n=this.getDomObject().querySelectorAll(selector),res=[];if(null===n){return null}else{oo._convertNodeListToArray(n).forEach(function(item){res.push((returnDom)?item:new Dom(item))});return res}},parent:function parent(){return new Dom(this.getDomObject().parentNode)},children:function children(){var c=this.getDomObject().children;return oo._convertNodeListToArray(c)},findParentByCls:function findParentByCls(cls){var p=this.getDomObject().parentNode;var pattern=new RegExp(cls);while(p&&(Node.DOCUMENT_NODE!==p.nodeType)&&!pattern.test(p.getAttribute("class"))){p=p.parentNode}if(p&&(Node.DOCUMENT_NODE!==p.nodeType)){return new Dom(p)}else{return false}},appendDomNode:function appendDomNode(domNode){this.getDomObject().appendChild(domNode);return this},prependDomNode:function prependDomNode(domNode){this.getDomObject().insertBefore(domNode,this.getDomObject().firstChild);return this},appendChild:function appendChild(node){if(node instanceof Dom){this.appendDomNode(node.getDomObject())}else{this.appendDomNode(node)}return this},prependChild:function prependChild(node){if(node instanceof Dom){this.prependDomNode(node.getDomObject())}else{this.prependDomNode(node)}return this},appendHtml:function appendHtml(html){this.getDomObject().innerHTML+=html;return this},prependHtml:function appendHtml(html){var h=this.getDomObject().innerHTML;h=html+h;return this},html:function html(htmlString){this.clear();this.appendHtml(htmlString)},removeChild:function removeChild(node){this.getDomObject().removeChild(node)},clear:function clear(){this.getDomObject().innerHTML="";return this},stopAnimation:function stopAnimation(){this.setWebkitTransitionDuration(0,"ms");this.getDomObject().removeEventListener("webkitTransitionEnd");return this},translateTo:function translateTo(coord,duration,listener,timingFunction){if(typeof coord==="object"){coord.x="undefined"!==typeof coord.x?coord.x:this.getTranslateX();coord.y="undefined"!==typeof coord.y?coord.y:this.getTranslateY()}var currentTransitionDuration=(this.getWebkitTransitionDuration()*1000);duration=duration||0;this.setWebkitTransitionDuration(duration,"ms");var currentTimingFunction=this.getWebkitTransitionTimingFunction();if(typeof timingFunction==="string"){this.setWebkitTransitionTimingFunction(timingFunction,"")}var that=this,endListener=function endListener(e){that.getDomObject().removeEventListener("webkitTransitionEnd",endListener);that.setWebkitTransitionTimingFunction(currentTimingFunction,"");if(listener){listener.call(that,e)}};this.getDomObject().addEventListener("webkitTransitionEnd",endListener,false);this.setTranslations(coord.x,coord.y);return this},setId:function setId(id){this.getDomObject().id=id},getId:function getId(id){return this.getDomObject().id},setTemplate:function setTemplate(tpl){this._template=tpl;return this},render:function render(data,tpl,resetCache){if(tpl){this.setTemplate(tpl)}if(!this._cacheTpl||resetCache){data=data||{};this._cacheTpl=Mustache.to_html(this._template,data)}this.appendHtml(this._cacheTpl);return this}})})(oo);(function(h){var n=this,m={};var l=h.getNS("oo.view").Element=h.Class(h.view.Dom,h.core.mixins.Events,h.core.mixins.Scroll,{STATIC:{APPEND:"append",PREPEND:"prepend",REFRESH_CONTENT:"refresh_content",register:function a(x,y){if(m[y]){throw"Already existing codename"}m[y]=x},get:function r(x){if(x in m){return m[x]}else{throw"Invalid codename"}},unregister:function a(x){delete m[x]},getTemplateEngine:function j(){if(null===l.templateEngine){l.templateEngine=new (h.view.templateengine.Template.get(h.getConfig("templateEngine")))()}return l.templateEngine},templateEngine:null},_uiElements:null,_needToRender:true,_tpl:null,_container:null,constructor:function p(x){if(!x||typeof x!="object"){throw'call Element constructor but "options" missing'}if(!x.hasOwnProperty("el")){throw'call Element constructor but "el" property of object options is missing'}l.Super.call(this,x.el);if(x.hasOwnProperty("template")){this.setTemplate(x.template);delete x.template}if(x.hasOwnProperty("onEnabled")){this.onEnabled=x.onEnabled;delete x.onEnabled}if(x.hasOwnProperty("scrollable")){this.setScrollable(conf.scrollable)}this._uiElements={}},getEl:function v(x){return this._uiElements[x]||null},addEl:function f(x){this._uiElements[x.getId()]=x;x.setContainer(this)},removeEl:function t(y){var x=this.getEl(y);if(null!==x){this._uiElements.slice(this._uiElements.indexOf(x),1);x.destroy()}},initElement:function q(){for(var y in this._uiElements){var x=this._uiElements[y];if("needToRender" in x&&x.needToRender()){x.renderTo(this)}}return this},createElement:function k(z,x){var y=h.createElement(z,x);this.addEl(y);return y},setContainer:function d(x){this._container=x},getContainer:function o(){return this._container},needToRender:function i(){return this._needToRender},setTemplate:function b(x){this._tpl=x||""},getTemplate:function s(){return this._tpl},render:function w(y,x){if(!x||""===x){x=this.getTemplate()}if(!x){return""}var z=l.getTemplateEngine();return z.render(x,y||{})},renderTo:function u(D,B,z,y){var A=this.render(B,z),C=D.find("#"+this.getId())||D;var E="",x="Child";if(typeof A==="string"){x="Html"}if([l.APPEND,l.PREPEND].indexOf(y)!==-1){E=y}else{if("Child"===x){E="append"}else{x=x.toLowerCase()}}C[E+x](A);this._onEnabled()},_onEnabled:function c(){this.onEnabled();this.initElement()},onEnabled:function g(){},triggerBubblingEvent:function e(z,A){if(!h.isArray(A)){A=A?[A]:[]}var y=this.getContainer(),x={bubble:true,stopPropagation:function(){this.bubble=false}};A.splice(0,0,x);this.triggerEvent(z,A);if(x.bubble&&y&&y.triggerBubblingEvent){y.triggerBubblingEvent(z,A)}}});h.view.Element.register(l,"node")})(oo);(function(h){var c=this;var i=h.getNS("oo.view").ModelElement=h.Class(h.view.Element,{_model:null,_tplError:null,setTemplateError:function e(m){this._tplError=m||""},getTemplateError:function g(){return this._tplError},constructor:function d(m){if(m.hasOwnProperty("model")){this.setModel(m.model);delete m.model}if(m.hasOwnProperty("templateError")){this.setTemplateError(m.templateError);delete m.templateError}i.Super.call(this,m)},afterFetch:function j(n){var m=this.render(n,this._tpl);this.appendHtml(m)},setModel:function l(m){if(m instanceof h.data.Model){this._model=m}else{this._model=h.createModel(m)}this._model.addListener(h.data.Model.AFTER_FETCH,h.createDelegate(function(n){this.renderTo(this,n.getData());if(this.isScrollable){this.scroll.refresh()}},this))},markAsError:function f(){this.renderTo(this.getContainer())},prepareData:function k(m){return m},render:function b(n,m){if(!n){m=this.getTemplateError()}return i.Super.prototype.render.call(this,this.prepareData(n||{}),m||null)},getModel:function a(){return this._model}});h.view.Element.register(i,"modelNode")})(oo);(function(oo){var global=this;var Viewport=oo.getNS("oo.view").Viewport=oo.Class(oo.view.Dom,{STATIC:{ANIM_RTL:"1",ANIM_LTR:"2",ANIM_UP:"3",ANIM_DOWN:"4",ANIM_SIBLING:"5",NO_ANIM:"none",ANIM_DURATION:750,APPEND_TO_STAGE:"append",PREPEND_TO_STAGE:"prepend"},constructor:function constructor(root){root=root||oo.getConfig("viewportSelector");Viewport.Super.call(this,root);this._panelClasses={};this._panels=[];this._panelsDic=[];this._enabledPanels=[];this._focusedStack=[];this._stages={main:{}}},hasPanel:function hasPanel(panel){return -1!=this._panelsDic.indexOf(panel)?true:false},addPanel:function addPanel(identifier,autoShow,autoRender,animDirection){var p=new (this._panelClasses[identifier])();p.setId(identifier);this._panels.push(p);this._panelsDic.push(identifier);if(autoRender||autoShow){if(!this.panelIsEnable(identifier)){this._enablePanel(identifier)}}if(autoShow){animDirection=autoRender||animDirection;this.showPanel(identifier,animDirection)}},_identifierToIndex:function _identifierToIndex(identifier){var index;if(typeof identifier=="string"){index=this._panelsDic.indexOf(identifier)}return index},_indexToIdentifier:function _indexToIdentifier(index){return this._panelsDic[index]},_enablePanel:function _enablePanel(identifier){var index=this._identifierToIndex(identifier),panel=this._panels[index];panel.renderTo(this);this._enabledPanels.push(index)},getFocusedPanel:function getFocusedPanel(getIndex){index=this._focusedStack[this._focusedStack.length-1];if(getIndex){return undefined!==index?index:false}else{return this.getPanel(this._indexToIdentifier(index))}},panelIsEnable:function panelIsEnable(identifier){return(-1!=this._enabledPanels.indexOf(this._identifierToIndex(identifier))?true:false)},removePanel:function removePanel(panel){var index=this._identifierToIndex(panel);this._panels[index].destroy();this._panels.slice(index,1);this._panelsDic.slice(index,1);this._enabledPanels.slice(this._enabledPanels.indexOf(index),1)},showPanel:function showPanel(panelIdentifier,direction){var p=this.getPanel(panelIdentifier);if(!this.panelIsEnable(panelIdentifier)){this._enablePanel(panelIdentifier)}p.show(direction||Viewport.ANIM_RTL);var index=this._identifierToIndex(panelIdentifier);this._focusedStack.push(index)},hidePanel:function hidePanel(panelIdentifier,direction,destroy){direction=direction||Viewport.ANIM_RTL;var p=this.getPanel(panelIdentifier);p.hide(direction||Viewport.ANIM_RTL);var index=this._identifierToIndex(panelIdentifier);if(index==this.getFocusedPanel(true)){this._focusedStack.pop()}},switchPanel:function switchPanel(oldPanel,newPanel,direction){var dir,oldP,newP;if(arguments.length<=2){dir=newPanel;newP=oldPanel;oldP=this._indexToIdentifier(this.getFocusedPanel(true))}else{oldP=oldPanel;newP=newPanel;dir=direction}if(!dir){var oldPStage=this._getStageDic()[oldP],newPStage=this._getStageDic()[newP];if(oldPStage==newPStage){var stageNS=this._stringToStageObj(oldPStage);if(stageNS.panels.indexOf(oldP)>stageNS.panels.indexOf(newP)){dir=Viewport.ANIM_LTR}else{dir=Viewport.ANIM_RTL}}else{dir=Viewport.NO_ANIM}}this.showPanel(newP,dir);if(oldP){this.hidePanel(oldP,dir)}},register:function register(id,p,stage,pos){this._panelClasses[id]=p;stage||(stage="main");var conf=oo.override({stage:"main",pos:Viewport.APPEND_TO_STAGE},{stage:stage,pos:pos});if(!this.addToStage(id,conf.stage,conf.pos)){throw"The panel has not been added to a stage - it has already been added in another stage"}},getPanel:function getPanel(identifier){if(!this.hasPanel(identifier)){this.addPanel(identifier,false,false)}return this._panels[this._identifierToIndex(identifier)]||false},_stages:null,_stageDic:null,_getStageDic:function _getStageDic(){this._stageDic||(this._stageDic={});return this._stageDic},_stringToStageObj:function _stringToStageObj(str){var stageObj;if("string"===typeof str){eval("stageObj = this._stages."+str)}return stageObj},getStage:function getStage(stage){return this._stringToStageObj(stage).panels||[]},createStage:function createStage(name,into){var re=/^[a-zA-Z]*$/,names=name.split("."),ns="this._stages";names.forEach(function(item){if(re.test(item)&&item!="panels"){ns+="."+item;eval(ns+" || ("+ns+" = {})")}else{throw"Invalid name or namespace for a stage name"}},this);return eval(ns)},removeStage:function removeStage(stage){var stageObj,lastIndex=stage.lastIndexOf("."),lastPart,parentStage;if(-1!==lastIndex){lastPart=stage.substr(lastIndex+1);parentStage=stage.substr(0,lastIndex);stageObj=this._stringToStageObj(parentStage)}else{lastPart=stage;stageObj=this._stages}stageObj[lastPart]=null;delete stageObj[lastPart]},addToStage:function addToStage(panel,stage,position){if(this._getStageDic()[panel]){return false}var stageObj,index=parseInt(position,10);stageObj=this._stringToStageObj(stage);if(!stageObj){stageObj=this.createStage(stage)}position=position||Viewport.APPEND_TO_STAGE;if(!stageObj.panels){stageObj.panels=[]}posToInsert=position==Viewport.APPEND_TO_STAGE?stageObj.panels.length:position==Viewport.PREPEND_TO_STAGE?0:null;if(null===posToInsert){stageObj.panels[parseInt(position,10)]=panel}else{stageObj.panels.splice(posToInsert,0,panel)}this._getStageDic()[panel]=stage;return true},removeFromStage:function removeFromStage(panel){var stageObj;stageObj=this._stringToStageObj(this._getStageDic()[panel]);stageObj.panels.splice(stageObj.panels.indexOf(panel),1);this._getStageDic()[panel]=null;delete this._getStageDic()[panel]}})})(oo||{});(function(e){var h=e.getNS("oo.view").Panel=e.Class(e.view.Element,{STATIC:{ON_SHOW:"on_show",ON_HIDE:"on_hide"},_data:null,constructor:function c(){h.Super.call(this,{el:document.createElement("div")});var l=this;this._data={};if("init" in this){this.init()}},render:function b(){this.classList.addClass("oo-panel");this.appendHtml(h.Super.prototype.render.call(this,this._data));return this},destroy:function i(){},show:function j(l){this.animShow(l);this.triggerEvent(h.ON_SHOW,[this])},animShow:function a(p){var m=e.view.Viewport,n=e.getViewport();p=p||m.ANIM_RTL;var l=0;if(p!==m.NO_ANIM){var o=n.getWidth(false,true)*(p==m.ANIM_RTL?1:-1);this.setTranslateX(o);l=m.ANIM_DURATION}this.setDisplay("block","");var q=this;this.translateTo({x:0},l)},hide:function d(l){this.animHide(l);this.triggerEvent(h.ON_HIDE,[this])},animHide:function g(q){var m=e.view.Viewport,n=e.getViewport();q=q||m.ANIM_RTL;var l=0;if(q!==m.NO_ANIM){l=m.ANIM_DURATION}var p=n.getWidth(false,true)*(q==m.ANIM_RTL?-1:1);var o=this;this.translateTo({x:p},l,function(){o.setDisplay("none")})},refresh:function f(){var l=e.getViewport();l.getWidth(null,true);l.getHeight(null,true)},setData:function k(l){this._data=l}})})(oo||{});(function(g){var c=g.core.Touch;var j=g.getNS("oo.view").List=g.Class(g.view.ModelElement,{STATIC:{EVT_ITEM_PRESSED:"item-pressed",EVT_ITEM_RELEASED:"item-released"},_structTpl:"",_touchedItem:null,_noStructure:true,_identityField:"",_listItemCls:"",_listItemDataAttrib:"",_eventInitialized:false,constructor:function d(k){var l={noStructure:true,structure:'<ul>{{#loop}}<li data-yellowjs-list-item-id="{{key}}" class="yellowjs-list-item">{{tpl}}</li>{{/loop}}</ul>',identityField:"key",listItemCls:"yellowjs-list-item",listItemDataAttrib:"data-yellowjs-list-item-id"};k=g.override(l,k);this._noStructure=!!k.noStructure;if(!this._noStructure){this._setStructTpl(k.structure)}this._identityField=k.identityField;this._listItemCls=k.listItemCls;this._listItemDataAttrib=k.listItemDataAttrib;j.Super.call(this,k)},setTemplate:function b(k){if(!this._noStructure){this._tpl=this._genTplWithStructure(k)}else{var l=/.*\{\{#loop\}\}.*\{\{\/loop\}\}.*/;if(!l.test(k)){throw'Invalid template - template should have a "loop" pattern'}this._tpl=k}},_initEvents:function a(){var m=this,l;function k(p){p=(Node.TEXT_NODE===p.nodeType)?p.parentNode:p;var n=new g.view.Dom(p);var q;if(!n.classList.hasClass(this._listItemCls)){var o=n.findParentByCls(m._listItemCls);if(o){n=o}}q=n.getDomObject().getAttribute(m._listItemDataAttrib)||n.getId();if(q){return{id:q,dom:n,row:(q?m.getModel().getBy(m._identityField,q):null)}}return false}this.getDomObject().addEventListener(c.EVENT_START,function(n){this._touchedItem=n.target;l=k(n.target);if(false!==l){l.dom.classList.addClass("active");m.triggerEvent(j.EVT_ITEM_PRESSED,[l.dom,l.id,l.row])}},false);this.getDomObject().addEventListener(c.EVENT_MOVE,function(o){if(this._touchedItem){this._touchedItem=null;var n=m.find(".active");if(null!==n){n.classList.removeClass("active")}}},false);this.getDomObject().addEventListener(c.EVENT_END,function(n){l=k(n.target);if(false!==l&&this._touchedItem==n.target){l.dom.classList.removeClass("active");m.triggerEvent(j.EVT_ITEM_RELEASED,[l.dom,l.id,l.row])}},false);this._eventInitialized=true},prepareData:function i(k){return{loop:k}},renderTo:function h(n,m,l){j.Super.prototype.renderTo.call(this,n,m,l);var k=this.getModel().getData();if(k.length){this.children().forEach(function(p,o){var q=new g.view.Dom(p);q.classList.addClass(this._listItemCls);q.getDomObject().setAttribute(this._listItemDataAttrib,k[o][this._identityField])},this)}if(!this._eventInitialized){this._initEvents()}},_genTplWithStructure:function f(k){return this._structTpl.replace("{{tpl}}",k||"")},_setStructTpl:function e(k){if(!k){throw Error("Template must be declared")}this._structTpl=k}});g.view.Element.register(j,"list")})(oo||{});(function(h){var d=h.core.Touch;var f=h.getNS("oo.view").Button=h.Class(h.view.Element,{STATIC:{EVT_TOUCH:"touch",EVT_RELEASE:"release"},constructor:function e(l){if(!l||typeof l!="object"){throw'call Element constructor but "options" missing'}if(!l.hasOwnProperty("el")){throw'call Element constructor but "el" property of object options is missing'}if(l.hasOwnProperty("onrelease")&&typeof l.onrelease==="function"){this.onRelease=l.onrelease;delete l.onRelease}f.Super.call(this,l);this._active=false;this._initEvents()},_needToRender:false,_initEvents:function a(){this.getDomObject().addEventListener(d.EVENT_START,h.createDelegate(this._onTouch,this),false);this.getDomObject().addEventListener(d.EVENT_MOVE,h.createDelegate(this._onMove,this),false);this.getDomObject().addEventListener(d.EVENT_END,h.createDelegate(this._onRelease,this),false)},_onTouch:function c(l){this.setActive(true);this.triggerEvent(f.EVT_TOUCH,[this,l])},_onMove:function g(l){this.setActive(false)},_onRelease:function i(l){if(this.isActive()){this.setActive(false);this.onRelease();this.triggerEvent(f.EVT_RELEASE,[this,l])}},onRelease:function j(){},isActive:function k(){return this._active},setActive:function b(l){this._active=!!l;this.classList[(this._active?"add":"remove")+"Class"]("active")}});h.view.Element.register(f,"button")})(oo||{});var oo=(function(y){var F=y.view.Dom,z=y.core.Touch,J=y.getNS("oo.view");var w=J.Carousel=y.Class(y.view.ModelElement,y.core.mixins.Events,{STATIC:{EVENT_ON:"EVENT_ON",EVENT_GOTO:"EVENT_GOTO",EVENT_PRESS:"EVENT_PRESS",CLS_SHOWING:"is-showing",CLS_ACTIVE:"item-active"},_datas:null,_elementCls:null,_items:null,_available:true,_newPanel:null,_upPrev:false,_upNext:false,_fromLimit:true,_activePanel:null,_transitionType:"Slide",_swipe:false,_pagerOpt:false,_startX:null,_currentTranslate:null,constructor:function b(R){if(!R){throw new Error("Missing options")}this._startX=0;this._startTranslate=0;var Q={target:R.el||(document.createElement("div"))};w.Super.call(this,Q);this._transitionDuration=R.duration||200;this._items=[];if(R&&R.hasOwnProperty("transitionType")){this._transitionType=R.transitionType.charAt(0).toUpperCase()+R.transitionType.slice(1);delete R.transitionType}if(R&&R.hasOwnProperty("swipe")){this._swipe=true;delete R.swipe}if(R&&R.hasOwnProperty("pager")){this._pagerOpt=R.pager;delete R.pager}if(R&&R.hasOwnProperty("model")){if(!R.hasOwnProperty("elementCls")){throw new Error("Options passed but missing elementCls")}if("[object Object]"!==Object.prototype.toString.call(R.elementCls)){throw new Error("elementCls must be an object")}this._elementCls=R.elementCls;delete R.elementCls;this._prepareModel(R.model)}else{this._prepareView()}},_prepareModel:function g(Q){var R=this;this.setModel(Q);this._model.fetch(function(S){R._datas=S;R._addPanel(0);R._addPanel(1);R._prepareView()})},updateModel:function H(Q){this.clear();this._items=[];this._available=true;this._datas=null;this._available=true;this._newPanel=null;this._upPrev=false;this._upNext=false;this._fromLimit=true;this._activePanel=null;this._prepareModel(Q)},_prepareView:function M(){this._nbPanel=this._datas.length-1||document.querySelectorAll([this._identifier," > *"].join("")).length;this._panelWidth=(new F(this.getDomObject().firstElementChild)).getWidth();var S=this.getDomObject().children,R=0,Q=S.length;for(R;R<Q;R++){S[R].style.width=this._panelWidth+"px"}this._activePanel=0;this["_prepareView"+this._transitionType]();this._displayPager=this._pagerOpt;this._pager=null;this._buildPager();this._moved=false;this.render()},_prepareViewSlide:function C(){this.setWidth((this._model)?this._panelWidth*3:this._panelWidth*this._nbPanel,"px")},_prepareViewCustom:function e(){this._items[this._activePanel].classList.addClass(w.CLS_ACTIVE)},_addPanel:function a(S,R){var Q=this._getItem(S);if(this._panelWidth){Q.setWidth(this._panelWidth,"px")}this[(R?"prependChild":"appendChild")](Q.getDomObject());Q.onEnable()},isAvailable:function B(){return this._available},showPanel:function L(T){if("undefined"===typeof T){throw new Error("Missing 'id' of the panel")}if(this._pager&&this._pager instanceof y.view.Slider){this._pager.setDisabled()}if(T!==this._activePanel&&this._datas[T]&&this._available){if(T>this._activePanel+1){this._updateNext(T);this._upPrev=true}if(T<this._activePanel-1){this._updatePrev(T);this._upNext=true}}this._available=false;var Q=(T<this._activePanel?+1:-1);this["_setTransition"+this._transitionType](T,Q);var R=this._activePanel?this._getItem(this._activePanel):null,S=this._getItem(this._newPanel);this.triggerEvent(w.EVENT_GOTO,[this._newPanel,R,S]);this._updatePager(this._newPanel);if(this._newPanel===this._activePanel){this._available=true;if(this._pager&&this._pager instanceof y.view.Slider){this._pager.setEnabled()}}},_setTransitionSlide:function s(S,R){var Q;if(S>=0&&S<=this._nbPanel&&S!==this._activePanel){Q=this._currentTranslate+R*this._panelWidth}else{if(S===this._activePanel){Q=this._currentTranslate}else{if(S<0){Q=0;S=0}else{Q=this._currentTranslate;S=this._nbPanel}}}this.translateTo({x:Q},this._transitionDuration);this._currentTranslate=Q;this._newPanel=S},_setTransitionCustom:function m(S,Q){var R=this;if(S<0){S=0}else{if(S>this._nbPanel){S=this._nbPanel}}if(S!==this._activePanel&&!this._items[S].classList.hasClass(w.CLS_SHOWING)){if(!this._items[S].isInit){this._items[S].getDomObject().addEventListener("webkitTransitionEnd",function(){R.onEndTransition.apply(R)},false);this._items[S].isInit=true}setTimeout(function(){R._items[S].classList.addClass(w.CLS_SHOWING)},1)}else{this._available=true}this._newPanel=S},_updateNext:function E(Q){this.removeChild(this.getDomObject().lastChild);this._addPanel(Q)},_updatePrev:function h(Q){this.removeChild(this.getDomObject().firstChild);this._addPanel(Q,true)},_getItem:function q(R){var Q=this._items;if(!Q[R]){Q[R]=this._prepareItem(R)}return Q[R]},_prepareItem:function o(T){var S,Q=this._datas[T].elementCls,R=this;if("undefined"===this._elementCls[Q]||"function"!==typeof this._elementCls[Q]){throw new Error("element Cls must exist and be a function")}S=new this._elementCls[Q]();S.data=this._datas[T];S.appendHtml(S.render(S.data));return S},_buildPager:function A(){if(this._displayPager){if("boolean"===typeof this._displayPager){this._buildPagerItem()}else{this._pager=this._displayPager;if(this._displayPager instanceof y.view.List){this._buildPagerList()}if(this._displayPager instanceof y.view.Slider){this._buildPagerSlider()}if(this._displayPager instanceof y.view.PagerPrevNext){this._buildPagerPrevNext()}}}},_buildPagerItem:function n(){this._pager=F.createElement("div");this._pager.classList.addClass("carousel-pager");this._pager.setTemplate('{{#bullet}}<i class="dot"></i>{{/bullet}}');var R=[];for(var Q=0;Q<this._nbPanel;Q++){R.push(Q)}this._pager.render({bullet:R})},_buildPagerList:function f(){var Q=this;this._pager.addListener(y.view.List.EVT_ITEM_RELEASED,function(R,S){if(parseInt(S,10)===Q._activePanel||!Q._available){return}Q.showPanel(parseInt(S,10))})},_buildPagerSlider:function u(){var Q=this;this._pager.addListener(y.view.SliderCursor.EVT_ONGOTO,function(R){if(Q.isAvailable()){Q.showPanel(R)}})},_buildPagerPrevNext:function c(){var Q=this;this._pager.addListener(y.view.PagerPrevNext.goToNext,function(){Q.goToNext.call(Q)});this._pager.addListener(y.view.PagerPrevNext.goToPrev,function(){Q.goToPrev.call(Q)})},_updatePager:function O(R){if(this._displayPager){if("boolean"===typeof this._displayPager){var Q=this._pager.getDomObject().querySelector(".dot.active");if(Q){Q.className=Q.className.replace(/ *active/,"")}this._pager.getDomObject().querySelector([".dot:nth-child(",(this._activePanel+1),")"].join("")).className+=" active"}else{if(this._pager instanceof y.view.Slider){this._pager.goTo(R)}if(this._pager instanceof y.view.PagerPrevNext){if(0===R){this._pager.buttonPrev.classList.addClass(y.view.PagerPrevNext.CLS_DISABLE)}else{this._pager.buttonPrev.classList.removeClass(y.view.PagerPrevNext.CLS_DISABLE)}if(this._nbPanel===R){this._pager.buttonNext.classList.addClass(y.view.PagerPrevNext.CLS_DISABLE)}else{this._pager.buttonNext.classList.removeClass(y.view.PagerPrevNext.CLS_DISABLE)}}}}},hasMoved:function v(){return this._moved},_initListeners:function j(){var R=this.getDomObject();var Q=this;var S;R.addEventListener(z.EVENT_START,function(T){if(Q._available){Q._startX=this._lastPos=z.getPositionX(T);Q["_transitionStart"+Q._transitionType]();S=0;Q.triggerEvent(w.EVENT_PRESS)}},false);R.addEventListener(z.EVENT_MOVE,function(U){if(U.type=="mousemove"){return}if(Q._available){this._lastPos=z.getPositionX(U);var T=this._lastPos-this._startX;if(Math.abs(T)>70){Q["_transitionMove"+Q._transitionType](T);Q._moved=true}}},false);R.addEventListener(z.EVENT_END,function(){if(Q._available){Q._moved=false;var T=this._lastPos,U=T-Q._startX;Q["_transitionEnd"+Q._transitionType](T,U)}},false);window.addEventListener("orientationchange",function(){Q.refresh()},false);if(this._swipe){R.addEventListener("swipeRight",function(T){Q.goToNext()},false);R.addEventListener("swipeLeft",function(T){Q.goToPrev()},false)}if(this._transitionType!=="Custom"){R.addEventListener("webkitTransitionEnd",function(T){Q.onEndTransition()},false)}},_transitionStartSlide:function l(){this._startTranslate=this.getTranslateX()},_transitionMoveSlide:function k(Q){this.translateTo({x:(this._startTranslate+Q)},0)},_transitionEndSlide:function G(Q,R){if(Math.abs(R)>150){if(Q-this._startX<0){this.goToNext()}else{this.goToPrev()}}else{this.translateTo({x:(null!==this._currentTranslate)?this._currentTranslate:(this._currentTranslate=this._startTranslate)},this._transitionDuration)}},_transitionStartCustom:function p(){},_transitionMoveCustom:function K(){},_transitionEndCustom:function I(){},goToNext:function i(){if(this._available){this.showPanel(this._activePanel+1)}},goToPrev:function D(){if(this._available){this.showPanel(this._activePanel-1)}},onEndTransition:function P(){if(this._activePanel==this._newPanel){this._available=true;return}this["_endTransition"+this._transitionType](this._newPanel);if(this._newPanel>this._activePanel){if(!this._fromLimit){this.removeChild(this.getDomObject().firstChild);if(this._transitionType=="Slide"){this.translateTo({x:this._currentTranslate+this._panelWidth});this._currentTranslate=this._currentTranslate+this._panelWidth}}if(this._newPanel<this._nbPanel){this._addPanel(this._newPanel+1)}}if(this._newPanel<this._activePanel){if(!this._fromLimit){this.removeChild(this.getDomObject().lastChild)}if(this._newPanel>0){if(this._transitionType=="Slide"){this.translateTo({x:this._currentTranslate-this._panelWidth})}this._addPanel(this._newPanel-1,true);if(this._transitionType=="Slide"){this._currentTranslate=this._currentTranslate-this._panelWidth}}}if(this._upPrev){this._updatePrev(this._newPanel-1);this._upPrev=false}if(this._upNext){this._updateNext(this._newPanel+1);this._upNext=false}this._fromLimit=(this._newPanel<1||this._newPanel==this._nbPanel)?true:false;this._activePanel=this._newPanel;this._available=true;if(this._pager&&this._pager instanceof y.view.Slider){this._pager.setEnabled()}this.triggerEvent(w.EVENT_ON,[this._activePanel])},_endTransitionSlide:function d(Q){},_endTransitionCustom:function t(Q){this._items[Q].classList.removeClass(w.CLS_SHOWING);this._items[this._activePanel].classList.removeClass(w.CLS_ACTIVE);this._items[Q].classList.addClass(w.CLS_ACTIVE)},render:function x(){if(this._pager){if("boolean"===typeof this._displayPager){(new F(this.getDomObject().parentNode)).appendChild(this._pager)}else{if(this._pager instanceof y.view.List){this._pager.appendHtml(this._pager.render(this._datas))}}}this._initListeners()},refresh:function N(){var Q=this._panelWidth,R;this._panelWidth=(new F(this.getDomObject().firstElementChild)).getWidth();R=Q-this._panelWidth;this.translateTo({x:this._currentTranslate+R},0);this._startTranslate=this._currentTranslate+R},getPanel:function r(Q){if(undefined===Q){throw new Error("Missing id")}if(!this._items){return}return this._items[Q]}});y.view.Element.register(w,"carousel");return y})(oo||{});(function(){var c=oo.core.Touch;var b=oo.getNS("oo.view").Slider=oo.Class(oo.view.ModelElement,{constructor:function a(e){b.Super.call(this,e)},goTo:function d(){throw"Can't be called directly from Slider class"}});oo.view.Element.register(b,"slider")})();(function(){var d=oo.core.Touch;var f=oo.getNS("oo.view").SliderCursor=oo.Class(oo.view.Slider,oo.core.mixins.Events,{_tplItems:"{{key}}",_tplOverlay:"{{key}}",_datas:null,_step:null,_total:null,_overlay:null,_enabled:true,STATIC:{EVT_ONGOTO:"onGoTo"},constructor:function g(k){f.Super.call(this,k);if(!k.hasOwnProperty("translate")){throw new Error("Missing translate property")}this._prepareView(k)},_initEvents:function a(m){var z=null,x=this,p=false,s=this.getDomObject(),n=this.getWidth(),w=this.getHeight(),q=s.offsetLeft,o=this._cursor.getDomObject().offsetTop,u=q+this._cursor.getWidth()/2+this._cursor.getLeft(),r=o+this._cursor.getHeight()/2+this._cursor.getTop(),l=q+n,k=o+w,v=(m.translate.x)?true:false,t=(m.translate.y)?true:false,A=null;var y;if(this._datas){this._step=(n/(x._total-1))/2}s.addEventListener(d.EVENT_START,function(B){if(!x.isEnabled()){return}z=d.getPosition(B);p=true;x._cursor.setWebkitTransitionDuration(0,"ms");if(v){A=z[0]-u;x._cursor.setTranslateX(A,"px");if(x._step&&x._overlay){x._overlay.setDisplay("block");y=((Math.ceil(A/x._step)-1)%2!==0)?Math.ceil(A/(x._step*2)):Math.ceil(A/(x._step*2)-1);x._updateOverlay(y)}}if(t){x._cursor.setTranslateY(z[1]-r,"px")}},false);s.addEventListener(d.EVENT_MOVE,function(D){if(!x.isEnabled()){return}var H=d.getPosition(D),B=H[0],G=H[1];var C=(((B-u)-A)>0)?"right":"left",F=false,E;if(p){if(v&&B>=q&&B<=l){A=B-u;x._cursor.setTranslateX(A,"px");if(x._step&&x._overlay){if("right"===C){if((Math.ceil(A/x._step)-1)%2!==0){E=Math.ceil(A/(x._step*2));F=true}}else{if((Math.ceil(A/x._step)-1)%2===0){E=Math.ceil(A/(x._step*2)-1);F=true}}if(F&&y!==E){y=E;x._updateOverlay(y)}}}if(t&&G>=o&&G<=k){x._cursor.setTranslateY(G-r,"px")}}},false);s.addEventListener(d.EVENT_END,function(B){if(!x.isEnabled()){return}p=false;if(parseInt(y,10)!==null){x.goTo(y);x.triggerEvent(f.EVT_ONGOTO,[y])}if(x._overlay){x._overlay.setDisplay("none")}},false)},goTo:function b(k){if(this._cursor){this._cursor.setTranslateX((k*(this._step*2))+this._cursor.getLeft()/2,"px");this._cursor.setWebkitTransitionDuration(200,"ms")}},_prepareView:function c(k){var l=this;var m=function m(){if(k.hasOwnProperty("cursor")){l._cursor=oo.createElement("node",{el:k.cursor});l._cursor.getDomObject().style.position="absolute";l.getDomObject().style.position="relative";l._initEvents(k)}};if(k.overlay){this._overlay=oo.createElement("node",{el:k.overlay,template:k.overlayTemplate||this._tplOverlay});this._overlay.setDisplay("none")}if(this._model){if(k.items){l._createItems(k)}this._model.fetch(function(n){l._datas=n;l._total=l._datas.length;if(l.list){l.list.appendHtml(l.list.render(n))}m()})}else{m()}},_updateOverlay:function e(k){this._overlay.appendHtml(this._overlay.render(this._datas[k]))},_createItems:function h(k){this.list=oo.createElement("list",{el:k.items.el,template:k.items.template||this._tplItems,model:this._model})},setDisabled:function i(){this._enabled=false},setEnabled:function i(){this._enabled=true},isEnabled:function j(){return this._enabled}});oo.view.Element.register(f,"sliderCursor")})();(function(l){var i=l.view.Dom,f=l.core.Touch,o=l.getNS("oo.view");var d=o.Popin=l.Class(l.view.Element,{STATIC:{CLS_OPENED:"pl-popin-opened",CLS_OPENING:"pl-popin-is-showing",CLS_CLOSING:"pl-popin-is-hiding",CLS_CLOSED:"pl-popin-closed"},_isOpened:true,onOpen:null,onClose:null,closeOnTap:false,constructor:function g(r){d.Super.call(this,r);if(r.hasOwnProperty("close")){this._createButtonClose(r.close)}if(r.hasOwnProperty("closeOnTap")){this.closeOnTap=r.closeOnTap}if(!this.classList){this.setDomObject()}this.onOpen=r.onOpen||l.emptyFn;this.onClose=r.onClose||l.emptyFn;this._initEvents();this._isOpened=(this.classList.hasClass(d.CLS_CLOSED))?false:true;if(this._isOpened&&!this.classList.hasClass(d.CLS_OPENED)){this._setOpened()}},_isClosing:function n(){return this.classList.hasClass(d.CLS_CLOSING)},_isOpening:function m(){return this.classList.hasClass(d.CLS_OPENING)},_opening:function c(){if(!this._isOpening()){this.classList.addClass(d.CLS_OPENING)}},_setOpened:function b(){if(this._isOpening()){this.classList.removeClass(d.CLS_OPENING)}if(!this.classList.hasClass(d.CLS_OPENED)){this.classList.addClass(d.CLS_OPENED)}},_closing:function e(){if(!this._isClosing()){this.classList.addClass(d.CLS_CLOSING)}},_setClosed:function h(){if(this._isClosing()){this.classList.removeClass(d.CLS_CLOSING)}if(!this.classList.hasClass(d.CLS_CLOSED)){this.classList.addClass(d.CLS_CLOSED)}},open:function j(){this.classList.removeClass(d.CLS_CLOSED);this.classList.removeClass(d.CLS_CLOSING);this._opening();this._isOpened=true;this.onOpen()},close:function p(){this.classList.removeClass(d.CLS_OPENED);this.classList.removeClass(d.CLS_OPENING);this._closing();this._isOpened=false;this.onClose()},_createButtonClose:function k(s){var r=l.createElement("button",s),t=this;r.addListener(l.view.Button.EVT_RELEASE,function(){t.close()})},isOpened:function q(){return this._isOpened},_initEvents:function a(){var r=this;this.getDomObject().addEventListener("webkitTransitionEnd",function(){r[!r._isOpened?"_setClosed":"_setOpened"]()},false);if(this.closeOnTap){var s=function s(){r.close()};this.getDomObject().addEventListener(l.core.Touch.EVENT_END,s,false)}}});l.view.Element.register(d,"popin")})(oo||{});(function(a){var b=a.view.Button;var e=a.getNS("oo.view").PagerPrevNext=a.Class(null,a.core.mixins.Events,{buttonPrev:null,buttonNext:null,STATIC:{goToNext:"goToNext",goToPrev:"goToPrev",CLS_DISABLE:"button-disable"},constructor:function c(f){if(!f){throw new Error("Missing options")}if(!f.hasOwnProperty("prev")||!f.hasOwnProperty("next")){throw new Error("Missing previous or next configuration")}this.buttonPrev=f.prev;this.buttonNext=f.next;delete f.buttonPrev;delete f.buttonNext;if(!(this.buttonPrev instanceof b)&&("string"===typeof this.buttonPrev||"object"===typeof this.buttonPrev)){this.buttonPrev=a.createElement("button",{el:this.buttonPrev})}if(!(this.buttonNext instanceof b)&&("string"===typeof this.buttonNext||"object"===typeof this.buttonNext)){this.buttonNext=a.createElement("button",{el:this.buttonNext})}this._attachEvents()},_attachEvents:function d(){var f=this;this.buttonPrev.addListener(b.EVT_RELEASE,function(){f.triggerEvent(e.goToPrev)});this.buttonNext.addListener(b.EVT_RELEASE,function(){f.triggerEvent(e.goToNext)})}});a.view.Element.register(e,"pagerPrevNext")})(oo||{});(function(c){var g=c.view.Dom,f=c.core.Touch;var b=c.getNS("oo.view").Accordion=c.Class(c.view.Element,{STATIC:{CLS_OPENED:"accordion-section-opened",CLS_CLOSED:"accordion-section-closed",SELET_HEADER:"[data-accordionheader]",SELET_SECTION:"[data-accordioncontent]"},_isOpened:true,_needToRender:false,_openedSection:null,constructor:function e(i){b.Super.call(this,i);this._prepareView()},_prepareView:function h(){var j=this,i=function i(l,k){if(k.classList.hasClass(b.CLS_OPENED)){j.closeSection(k)}else{j.openSection(k)}j.triggerBubblingEvent(c.view.Element.REFRESH_CONTENT)};this.children().forEach(function(m){var l=new c.view.Dom(m);j.closeSection(l);var k=c.createElement("button",{el:l.find("[data-accordionheader]",true)});k.addListener(c.view.Button.EVT_RELEASE,function(n){i(n,l)})})},closeSection:function a(i){i.classList.removeClass(b.CLS_OPENED);i.classList.addClass(b.CLS_CLOSED)},openSection:function d(i){if(this._openedSection!==null){this.closeSection(this._openedSection)}i.classList.removeClass(b.CLS_CLOSED);i.classList.addClass(b.CLS_OPENED);this._openedSection=i}});c.view.Element.register(b,"accordion")})(oo||{});(function(g){var e=g.view.Dom,b=g.core.Touch;var h={};var a=g.getNS("oo.view.scroll").Scroll=g.Class(null,g.core.mixins.Events,{STATIC:{register:function j(k,l){if(h[l]){throw"Already existing codename"}h[l]=k},get:function c(k){if(k in h){return h[k]}else{throw"Invalid codename"}},unregister:function j(k){delete h[k]}},constructor:function d(){},scrollTo:function f(){throw"Can't be called directly from Scroll class"},refresh:function i(){throw"Can't be called directly from Scroll class"}})})(oo||{});(function(a){var d=a.view.Dom,f=a.view.scroll.Scroll;var e=a.getNS("oo.view.scroll").IScroll=a.Class(f,{_scroll:null,el:null,constructor:function c(g){if(undefined===g||!g.hasOwnProperty("el")||"object"!==typeof g){throw new Error('Missing options or missing "el" property in your options or options is not an object')}this.el=g.el;delete g.el;var h=!(this.el instanceof d);if("string"!==typeof this.el&&"undefined"===typeof this.el.nodeType&&h){throw new Error("el must be a Dom object, a oo.view.Dom or an identifier")}if(h){this.el=new d(this.el)}e.Super.call(this);this._scroll=new iScroll(this.el.getId(),g)},refresh:function b(){this._scroll.refresh()}});f.register(e,"iscroll")})(oo||{});